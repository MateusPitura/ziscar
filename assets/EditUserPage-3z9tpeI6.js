import{r as l,j as a,v as E,w as S,t as U,x as g,G as P,a as b,y as v,p as j,z as f}from"./index-DpCb8Zub.js";import{u as F}from"./Section-ZokTC3Gm.js";import{U as A}from"./UserForm-DCmtf2y0.js";import{a as m}from"./index-BT4GbdeD.js";import{s as C}from"./safeFormat-pk_71gGN.js";import"./Loading-IUelIp8A.js";import"./Choice-X1RMTa7h.js";const D=l.createContext(null);function q({children:e}){const[n,o]=l.useState(!1);function i(r){o(r)}const s=l.useMemo(()=>({example:n,handleExample:i}),[n]);return a.jsx(D.Provider,{value:s,children:e})}function M(e){var n,o,i,s,r,u,t,c;return{fullName:e.fullName,email:e.email,cellPhone:m(e.cellPhone,"cellphone")??"",cpf:m(e.cpf,"cpf")??"",code:e.code??"",birthDate:e.birthDate?C({date:e.birthDate,format:"yyyy-MM-dd"}):"",roleId:((n=e.roleId)==null?void 0:n.toString())??"",address:{cep:m((o=e.address)==null?void 0:o.cep,"cep")??"",number:((i=e.address)==null?void 0:i.number)??"",street:((s=e.address)==null?void 0:s.street)??"",complement:((r=e.address)==null?void 0:r.complement)??"",neighborhood:((u=e.address)==null?void 0:u.neighborhood)??"",city:((t=e.address)==null?void 0:t.city)??"",state:((c=e.address)==null?void 0:c.state)??""}}}function N(){const{safeFetch:e}=E(),{showSuccessSnackbar:n}=S(),o=F({queryKey:["cepApi"]}),i=U(),s=g(),{userId:r}=P();async function u(){return await e(`${f}/user/${r}`,{resource:"USERS",action:"READ"})}const{data:t,isFetching:c}=b({queryKey:["user",r],queryFn:u,select:M});async function p(x){await e(`${f}/user/${r}`,{method:"PATCH",body:x,resource:"USERS",action:"UPDATE"})}const{mutate:y,isPending:h,isSuccess:d}=v({mutationFn:p,onSuccess:async()=>{n({title:`Usuário ${t==null?void 0:t.fullName} atualizado com sucesso`}),s.invalidateQueries({queryKey:["usersDashboard"]}),i("/users")}});return l.useEffect(()=>()=>{d&&s.invalidateQueries({queryKey:["user"]})},[d,s]),c?a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(j,{})}):t&&a.jsx(A,{defaultValues:t,onSubmit:y,isPending:h||!!o,headerPrimaryBtnLabel:"Alterar",headerTitle:"Alterar usuário",onlyDirty:!0,resource:"USERS",action:"UPDATE"})}function k(){return a.jsx(q,{children:a.jsx(N,{})})}export{k as default};
