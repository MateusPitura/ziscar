import{r as d,j as e,c as g,X as J,a as W,b as h,B as x,I as Y,u as Z,S as ee,f as te,d as N,e as w,g as $,h as C,i as F,k as P,l as U,T as S,m as v,n as ae,o as se}from"./index-aVBDU0Ve.js";import{C as j,P as ne}from"./Choice-CQV22enN.js";import{R as re,C as k,T as oe,a as T,P as le,b as B,O as L,D as H,c as ie,d as ce,u as de,e as q,f as ue,F as xe,S as me,g as fe,I as he,h as y}from"./Dialog-DJzmwurf.js";import{u as O}from"./useDialogContext-xhCSAYNE.js";const pe=d.createContext(null);function je({children:t}){const[a,s]=d.useState("");function n(o){s(o)}const r=d.useMemo(()=>({example:a,handleExample:n}),[a]);return e.jsx(pe.Provider,{value:r,children:t})}const be=re,ge=oe,ye=k,ve=le,M=d.forwardRef(({className:t,...a},s)=>e.jsx(L,{className:g("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s}));M.displayName=L.displayName;const Ne=W("fixed z-50 gap-4 bg-white p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500 dark:bg-neutral-950",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),K=d.forwardRef(({side:t="right",className:a,children:s,...n},r)=>e.jsxs(ve,{children:[e.jsx(M,{}),e.jsxs(B,{ref:r,className:g(Ne({side:t}),a),...n,children:[s,e.jsxs(k,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-neutral-950 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-neutral-100 dark:ring-offset-neutral-950 dark:focus:ring-neutral-300 dark:data-[state=open]:bg-neutral-800",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));K.displayName=B.displayName;const z=({className:t,...a})=>e.jsx("div",{className:g("flex flex-col space-y-2 text-center sm:text-left",t),...a});z.displayName="SheetHeader";const Q=d.forwardRef(({className:t,...a},s)=>e.jsx(T,{ref:s,className:g("text-lg font-semibold text-neutral-950 dark:text-neutral-50",t),...a}));Q.displayName=T.displayName;const Ee=d.forwardRef(({className:t,...a},s)=>e.jsx(H,{ref:s,className:g("text-sm text-neutral-500 dark:text-neutral-400",t),...a}));Ee.displayName=H.displayName;function Se({children:t,...a}){return e.jsx(ie,{...a,children:e.jsxs(be,{open:a.isOpen,onOpenChange:a.handleOpen,children:[t,e.jsx(ce,{className:"hidden"})]})})}function Ce({children:t}){return e.jsx(ge,{asChild:!0,children:t})}function Fe({children:t}){return e.jsx(K,{className:"bg-white rounded-tl-md flex flex-col p-0 gap-0 justify-between",children:t})}function Ue({label:t}){return e.jsx(z,{className:"p-6",children:e.jsx(Q,{children:e.jsx("span",{className:"text-title-large text-neutral-700",children:t})})})}function Re({children:t,className:a}){return e.jsx("div",{className:h("px-6 flex-1 overflow-y-auto",a),children:t})}function De({primaryLabel:t,secondaryLabel:a="Cancelar",onPrimaryCallback:s,onSecondaryCallback:n,className:r,dirty:o,primaryBtnState:u,secondaryBtnState:c}){const m=de({dirty:o,buttonState:u});return e.jsxs("div",{className:h("p-6 border-t border-neutral-300 flex flex-0",r),children:[e.jsx(x,{label:t,onClick:s,type:"submit",state:m}),n?e.jsx(x,{label:a,variant:"quaternary",onClick:n,state:c}):e.jsx(ye,{asChild:!0,children:e.jsx(x,{label:a,variant:"quaternary",state:c})})]})}const b=Object.assign(Se,{Trigger:Ce,Content:Fe,Header:Ue,Body:Re,Footer:De});function we({className:t,...a}){return e.jsx("div",{className:g("animate-pulse rounded-md bg-neutral-100 dark:bg-neutral-800",t),...a})}function Ae({children:t,isLoading:a,className:s}){return a?e.jsx(we,{className:h("bg-neutral-300",s),children:e.jsx("div",{className:"invisible",children:"Loading"})}):e.jsx("div",{className:s,children:t})}function $e({children:t}){return e.jsx("div",{className:"overflow-x-auto flex flex-1",children:e.jsx("div",{className:"min-w-[50rem] w-full flex flex-col",children:t})})}function R({children:t,className:a,gridColumns:s="default"}){let n=s;return s==="default"?n=10:s==="auto"&&(n=(d.Children.count(t)-2)*2+2),e.jsx("div",{className:h("p-4 grid gap-2 bg-neutral-50 h-[72px] items-center border-b border-neutral-300 last:border-b-0",a),style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`},children:t})}function Pe({children:t,className:a,gridColumns:s}){return e.jsx(R,{className:h("bg-neutral-50 border border-neutral-300 rounded-t-md",a),gridColumns:s,children:t})}function V({label:t,className:a,colSpan:s}){const n=s??2;return e.jsx("span",{className:h("text-neutral-700 text-body-medium overflow-x-hidden",a,{"first:!col-span-1":!s}),style:{gridColumn:`span ${n} / span ${n}`},children:t})}function ke({className:t,colSpan:a=1,children:s}){return e.jsx("div",{className:h("overflow-x-hidden flex justify-end gap-2",t),style:{gridColumn:`span ${a} / span ${a}`},children:s})}function Te({label:t,className:a,action:s=!1,colSpan:n}){return e.jsx(V,{className:h("!text-body-large",a,{"!col-span-1":s}),label:t,colSpan:n})}function Be({children:t,isEmpty:a,isLoading:s,action:n,resource:r}){const o=Z(r,n);return s||a?e.jsx("div",{className:"flex-1 bg-neutral-50 overflow-y-auto flex items-center justify-center border-x border-b rounded-b-md border-neutral-300",children:s?e.jsx(ee,{}):e.jsx("span",{className:"text-neutral-700 text-body-medium",children:o?"Nenhum item encontrado":te({resource:r,action:n})})}):e.jsx("div",{className:"flex-1 bg-neutral-50 border-x border-b rounded-b-md border-neutral-300 overflow-y-auto",children:t})}function Le({className:t,currentStartItem:a=1,itemsPerPage:s=Y,totalItems:n,onClickNavigateBtn:r,isLoading:o}){const u=(a-1)*s,c=n&&n<=u+s;function m(){r&&r(c?a:a+1)}function p(){r&&r(a===1?1:a-1)}return e.jsxs(R,{className:h("bg-neutral-50 rounded-b-md border-none !flex items-center gap-4 justify-center",t),gridColumns:1,children:[e.jsx(x,{variant:"quaternary",iconLeft:"NavigateBefore",onClick:p,label:"Anterior",state:o?"loading":a===1?"disabled":void 0}),e.jsx(Ae,{isLoading:!!o,className:"text-neutral-700 text-body-large",children:n&&e.jsxs(e.Fragment,{children:[`${u+1}`,`-${c?n:u+s}`,` de ${n}`]})}),e.jsx(x,{variant:"quaternary",iconRight:"NavigateNext",onClick:m,label:"Próxima",state:o?"loading":c||!n?"disabled":void 0})]})}function He({onFilterCallback:t,filterBtnState:a,form:s}){const n=q();return e.jsxs(b,{...n,children:[e.jsx(b.Trigger,{children:e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{variant:"secondary",label:"Filtros",iconRight:"FilterList",onClick:t,state:a})})}),e.jsxs(b.Content,{children:[e.jsx(b.Header,{label:"Filtros"}),s]})]})}const i=Object.assign($e,{Row:R,Cell:V,Header:Pe,Head:Te,Body:Be,Footer:Le,Filter:He,Action:ke});function qe(t){const a=[];for(const s of t.data)a.push({...s,cellPhone:ue(s==null?void 0:s.cellPhone,"cellphone")});return{total:t.total,data:a}}function Oe(){const{usersFilter:t,handleUsersFilter:a}=N(),{closeDialog:s}=O();function n(r){a({page:1,...r}),s()}return e.jsx(xe,{schema:me,onSubmit:n,className:"flex-1 flex flex-col",defaultValues:{fullName:(t==null?void 0:t.fullName)||"",orderBy:(t==null?void 0:t.orderBy)||"fullName",status:(t==null?void 0:t.status)||"active"},replaceEmptyStringToNull:!1,children:e.jsx(Me,{})})}function Me(){const{reset:t}=fe(),{handleUsersFilter:a}=N(),{closeDialog:s}=O();function n(){a(w),t(w),s()}return e.jsxs(e.Fragment,{children:[e.jsxs(b.Body,{className:"flex flex-col gap-4",children:[e.jsx("span",{className:"text-label-medium text-neutral-700",children:"Buscar por"}),e.jsx(he,{name:"fullName",label:"Nome completo"}),e.jsx("span",{className:"text-label-medium text-neutral-700",children:"Ordenar por"}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs(j,{name:"orderBy",hideErrorLabel:!0,children:[e.jsx(j.Radio,{label:"Nome",value:"fullName"}),e.jsx(j.Radio,{label:"Email",value:"email"})]})}),e.jsx("span",{className:"text-label-medium text-neutral-700",children:"Status"}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs(j,{name:"status",hideErrorLabel:!0,children:[e.jsx(j.Radio,{label:"Ativo",value:"active"}),e.jsx(j.Radio,{label:"Inativo",value:"inactive"})]})})]}),e.jsx(b.Footer,{primaryLabel:"Aplicar",secondaryLabel:"Limpar",onSecondaryCallback:n,dirty:!0})]})}const Ke=d.memo(Oe);function A(t){const a=t,s=[];for(const r in a)a[r]&&(Array.isArray(a[r])?a[r].length&&s.push(`${r}=${a[r].join(",")}`):s.push(`${r}=${a[r]}`));return s.join("&")}function ze({fullName:t,userId:a,isActive:s,handleDisableUserInfo:n}){const r=$(),{safeFetch:o}=C(),{showSuccessSnackbar:u}=F(),c=P();async function m(){await o(`${v}/user/${a}`,{method:"DELETE",body:{isActive:!0},resource:"USERS",action:"DELETE"})}const{mutate:p,isPending:E}=U({mutationFn:m,onSuccess:()=>{c.invalidateQueries({queryKey:["users"]}),u({title:`Usuário ${t} ativado com sucesso`})}});return s?e.jsxs(e.Fragment,{children:[e.jsx(S,{content:"Editar",children:e.jsx(x,{variant:"quaternary",iconLeft:"Edit",onClick:()=>r(`/users/edit/${a}`),resource:"USERS",action:"UPDATE",padding:"none"})}),e.jsx(S,{content:"Desativar",children:e.jsx(x,{variant:"primary",iconLeft:"Delete",color:"red",padding:"none",onClick:()=>n({userName:t,userId:a}),resource:"USERS",action:"DELETE"})})]}):e.jsx(S,{content:"Ativar",children:e.jsx(x,{variant:"quaternary",onClick:p,state:E?"loading":void 0,resource:"USERS",action:"DELETE",padding:"none",iconLeft:"ToggleOn"})})}function Qe({userId:t,userName:a,...s}){const{safeFetch:n}=C(),{showSuccessSnackbar:r}=F(),o=P(),{handleUsersFilter:u}=N();async function c(){await n(`${v}/user/${t}`,{method:"DELETE",body:{isActive:!1},resource:"USERS",action:"DELETE"})}const{mutate:m,isPending:p}=U({mutationFn:c,onSuccess:()=>{u({page:1}),o.invalidateQueries({queryKey:["users"]}),r({title:`Usuário ${a} desativado com sucesso`}),s.closeDialog()}});return e.jsxs(y,{...s,children:[e.jsx(y.Header,{title:"Desativar usuário"}),e.jsx(y.Body,{children:e.jsxs("span",{className:"text-body-medium text-neutral-700",children:["Tem certeza que deseja desativar o usuário",e.jsxs("span",{className:"font-bold",children:[ae,a]}),"? Ao desativar ele não poderá mais acessar o sistema"]})}),e.jsx(y.Footer,{labelPrimaryBtn:"Desativar",onClickPrimaryBtn:m,primaryBtnState:p?"loading":void 0,primaryBtnColor:"red",primaryBtResource:"USERS",primaryBtnAction:"DELETE"})]})}function Ve(t){switch(t){case"pdf":return"pdf";case"sheet":return"xlsx"}}async function Ge({data:t,fileName:a,type:s}){const n=await t.blob(),r=window.URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=`${a}.${Ve(s)}`,document.body.appendChild(o),o.click(),document.body.removeChild(o)}function _e(){const[t,a]=d.useState({userName:"",userId:""}),s=q(),{safeFetch:n}=C(),{usersFilter:r,handleUsersFilter:o}=N();function u(l){s.openDialog(),a(l)}function c(l){o({page:l})}const m=d.useMemo(()=>r?A(r):"",[r]),p=d.useMemo(()=>r?A({fullName:r.fullName,status:r.status,orderBy:r.orderBy}):"",[r]);async function E(l){return await n(`${v}/user?${l}`,{resource:"USERS",action:"READ"})}const{data:f,isFetching:D}=se({queryKey:["users",m],queryFn:({queryKey:l})=>E(l[1]),select:qe}),{showSuccessSnackbar:G}=F();async function _(){return await n(`${v}/user/pdf?${p}`,{method:"GET",resource:"USERS",action:"READ",isExport:!0})}const{mutate:X,isPending:I}=U({mutationFn:_,onSuccess:l=>{G({title:"PDF gerado com sucesso",actionLabel:"Baixar",onActionClick:async()=>{Ge({data:l,fileName:"users",type:"pdf"})},actionBtnResource:"USERS",actionBtnAction:"READ"})}});return e.jsxs(e.Fragment,{children:[e.jsx(Qe,{...t,...s}),e.jsxs("div",{className:"flex gap-4 justify-end",children:[e.jsx(x,{variant:"primary",color:"darkBlue",label:"Exportar como PDF",iconRight:"FileDownload",onClick:X,state:I?"loading":void 0,resource:"USERS",action:"READ"}),e.jsx(i.Filter,{form:e.jsx(Ke,{})})]}),e.jsxs(i,{children:[e.jsxs(i.Header,{children:[e.jsx(i.Head,{label:"ID"}),e.jsx(i.Head,{label:"Nome completo"}),e.jsx(i.Head,{label:"Email"}),e.jsx(i.Head,{label:"Celular"}),e.jsx(i.Head,{label:"Status"}),e.jsx(i.Head,{action:!0})]}),e.jsx(i.Body,{isLoading:D,isEmpty:!(f!=null&&f.total),resource:"USERS",action:"READ",children:f==null?void 0:f.data.map(l=>e.jsxs(i.Row,{children:[e.jsx(i.Cell,{label:l.id}),e.jsx(i.Cell,{label:l.fullName}),e.jsx(i.Cell,{label:l.email}),e.jsx(i.Cell,{label:l.cellPhone}),e.jsx(i.Cell,{label:l.isActive?"Ativo":"Inativo"}),e.jsx(i.Action,{children:e.jsx(ze,{isActive:l.isActive,userId:l.id,fullName:l.fullName,handleDisableUserInfo:u})})]},l.id))}),e.jsx(i.Footer,{currentStartItem:r==null?void 0:r.page,totalItems:f==null?void 0:f.total,onClickNavigateBtn:c,isLoading:D})]})]})}function Xe(){const t=$();return e.jsxs("div",{className:"flex flex-col gap-4 h-full w-full",children:[e.jsx(ne,{title:"Usuários",children:e.jsx(x,{label:"Adicionar usuário",iconLeft:"PersonAdd",onClick:()=>t("/users/new"),resource:"USERS",action:"CREATE",color:"green"})}),e.jsx(_e,{})]})}function Ze(){return e.jsx(je,{children:e.jsx(Xe,{})})}export{Ze as default};
