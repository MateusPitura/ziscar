import{s as j,j as e,T as f,f as m,g as p,S as b,as as h,a as g,b as A,c as v,at as C,m as D,C as E,r as P,e as R}from"./index-CwQymCQa.js";import{P as S}from"./PageHeader-ciO4E3wM.js";import{T as t}from"./Table-C7F72B_O.js";import{a as M,A as q}from"./AccountStatus-CBmOtPUH.js";import{b as I,F as T,I as F,i as N}from"./schemas-BL4SC9at.js";import{u as B}from"./DialogContext-qdOZWBM2.js";import{D as c}from"./Dialog-D_sfX160.js";import{D as x}from"./DataField-CyBI8K2e.js";import{C as y}from"./Choice-DMQtnXq8.js";function V(a){const s=[];for(const r of a)s.push({...r,dueDate:j({date:r.dueDate,format:"dd/MM/yyyy"})??"",value:I(r.value,"money")??""});return s}function L({installment:a,handleInstallmentToPaymentMethodInfo:s}){return a.status==="PAID"?e.jsx(f,{content:"Visualizar método de pagamento",children:e.jsx(m,{variant:"quaternary",iconLeft:"ReceiptLong",onClick:()=>s(a),resource:"ACCOUNTS_RECEIVABLE",action:"UPDATE",padding:"none","data-cy":`button-edit-viewPaymentMethod-${a.id}`})}):e.jsx(f,{content:"Adicionar método de pagamento",children:e.jsx(m,{variant:"quaternary",iconLeft:"AddCard",onClick:()=>s(a),resource:"ACCOUNTS_RECEIVABLE",action:"READ",padding:"none","data-cy":`button-edit-addPaymentMethod-${a.id}`})})}function U(a){return{...a,paymentDate:j({date:a.paymentDate,format:"dd/MM/yyyy"})??""}}function H({installment:a,...s}){async function r(){return{id:1,paymentDate:"2025-01-01",type:"CREDIT_CARD"}}const{data:n,isFetching:u}=p({queryKey:["accounts-receivable-payment-method",a.id],queryFn:r,select:U});return e.jsxs(c,{...s,children:[e.jsx(c.Header,{title:"Detalhes do Método de Pagamento"}),e.jsx(c.Body,{children:e.jsx("div",{className:"flex flex-col gap-4 h-36 mb-8",children:u?e.jsx("div",{className:"flex justify-center items-center h-full w-full",children:e.jsx(b,{})}):e.jsxs(e.Fragment,{children:[e.jsx(x,{label:"Data do pagamento",value:n==null?void 0:n.paymentDate}),e.jsx(x,{label:"Forma de pagamento",value:n&&h[n==null?void 0:n.type]})]})})})]})}function k({installment:a,...s}){const{showSuccessSnackbar:r}=g(),n=A();async function u(l){console.log("data: ",l)}const{mutate:d,isPending:o}=v({mutationFn:u,onSuccess:()=>{r({title:"Método de pagamento adicionado"}),n.invalidateQueries({queryKey:["accounts-receivable-installments",a.id]}),n.invalidateQueries({queryKey:["accounts-receivable-payment-method",a.id]}),n.invalidateQueries({queryKey:["accounts-receivable"]}),s.closeDialog()}});return e.jsxs(c,{...s,children:[e.jsx(c.Header,{title:"Adicionar Método de Pagamento"}),e.jsx(c.Body,{children:e.jsxs(T,{schema:M,defaultValues:C,onSubmit:d,className:"flex flex-col gap-4",children:[e.jsx(F,{name:"paymentDate",label:"Data do pagamento",required:!0,type:"date"}),e.jsx(N,{label:"Forma de pagamento",required:!0}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsx(y,{required:!0,children:Object.values(D).map(l=>e.jsx(y.Radio,{label:h[l],name:"type",value:l},l))})}),e.jsx(c.Footer,{labelPrimaryBtn:"Adicionar",className:"px-0",dirty:!1,primaryBtnState:o?"loading":void 0,primaryBtnResource:"ACCOUNTS_RECEIVABLE",primaryBtnAction:"CREATE"})]})})]})}function w({installment:a,...s}){if(a)return a.status==="PAID"?e.jsx(H,{installment:a,...s}):e.jsx(k,{installment:a,...s})}function O(){const{accountReceivableId:a}=E(),[s,r]=P.useState(null),n=B();function u(i){n.openDialog(),r(i)}async function d(){return[{id:1,dueDate:"2025-01-01",installmentSequence:0,status:"PAID",value:"10000",isRefund:!1,isUpfront:!0},{id:2,dueDate:"2025-01-01",installmentSequence:1,status:"PAID",value:"10000",isRefund:!1,isUpfront:!1},{id:3,dueDate:"2025-02-01",installmentSequence:2,status:"PENDING",value:"10000",isRefund:!1,isUpfront:!1},{id:4,dueDate:"2025-03-01",installmentSequence:3,status:"PENDING",value:"10000",isRefund:!1,isUpfront:!1}]}const{data:o,isFetching:l}=p({queryKey:["accounts-receivable-installments",a],queryFn:d,select:V});return e.jsxs(e.Fragment,{children:[e.jsx(w,{installment:s,...n}),e.jsxs(t,{children:[e.jsxs(t.Header,{children:[e.jsx(t.Head,{label:"ID"}),e.jsx(t.Head,{label:"Sequência"}),e.jsx(t.Head,{label:"Vencimento"}),e.jsx(t.Head,{label:"Valor"}),e.jsx(t.Head,{label:"Status"}),e.jsx(t.Head,{action:!0})]}),e.jsx(t.Body,{isLoading:l,isEmpty:!(o!=null&&o.length),resource:"ACCOUNTS_RECEIVABLE",action:"READ",children:o==null?void 0:o.map(i=>e.jsxs(t.Row,{children:[e.jsx(t.Cell,{label:String(i.id)}),e.jsx(t.Cell,{label:i.isUpfront?"Entrada":`${i.installmentSequence}/${o==null?void 0:o.length}`}),e.jsx(t.Cell,{label:i.dueDate}),e.jsx(t.Cell,{label:i.value}),e.jsx(t.Cell,{label:e.jsx(q,{status:i.status})}),e.jsx(t.Action,{children:e.jsx(L,{installment:i,handleInstallmentToPaymentMethodInfo:u})})]},i.id))})]})]})}function _(){const a=R();return e.jsxs("div",{className:"flex flex-col gap-4 h-full w-full",children:[e.jsx(S,{title:"Detalhes da Conta a Receber",children:e.jsx(m,{variant:"quaternary",label:"Voltar",iconLeft:"ArrowBack",onClick:()=>a("/accounts-receivable"),action:"READ",resource:"ACCOUNTS_RECEIVABLE","data-cy":"back-accounts-receivable-button"})}),e.jsx(O,{})]})}function Z(){return e.jsx(_,{})}export{Z as default};
