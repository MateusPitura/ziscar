import{a,u as A,b as g,i as x,c as F,n as P,f as T,d as j,r as U,j as r,S as q,e as u}from"./index-CrVTpVTI.js";import{s as N,p as R}from"./parseAddressToUpdate-D-oUqR3S.js";import{u as b}from"./useIsFetching-Dh2N-bBa.js";import{C as v}from"./CustomerForm-C-kqv_yO.js";import"./schemas-B7gcU9vp.js";import"./useButtonState-C7TXS9Jx.js";import"./AddressFields-DlZGQI2J.js";import"./FieldArray-DswNorv6.js";import"./Select-CB-6jpCF.js";import"./dialog-Ct9-qcrh.js";import"./PageHeader-DARJqnt5.js";import"./Section-DVwlB0L5.js";import"./index-3HpwEXPJ.js";import"./index-CLx72V5J.js";import"./CustomerFormInputs-D0n1tHjT.js";function w(e){return{fullName:e.fullName,email:e.email??"",phone:a(e.phone,"phone")??"",cpf:a(e.cpf,"cpf")??"",address:N(e.address)}}function K(){const{safeFetch:e}=A(),{showSuccessSnackbar:c}=g(),m=b({queryKey:["cepApi"]}),d=x(),o=F(),{customerId:t}=P();async function l(){return await e(`${u}/customer/${t}`,{resource:"CUSTOMERS",action:"READ"})}const{data:s,isFetching:p}=T({queryKey:["customer",t],queryFn:l,select:w});async function f(S){const{address:h,...E}=S,n=R({newAddress:h,oldAddress:s==null?void 0:s.address});await e(`${u}/customer/${t}`,{method:"PATCH",body:{...E,...n&&{address:n}},resource:"CUSTOMERS",action:"UPDATE"})}const{mutate:y,isPending:C,isSuccess:i}=j({mutationFn:f,onSuccess:async()=>{c({title:`Cliente ${s==null?void 0:s.fullName} atualizado com sucesso`}),o.invalidateQueries({queryKey:["customers"]}),d("/customers")}});return U.useEffect(()=>()=>{i&&o.invalidateQueries({queryKey:["customer",t]})},[i,o,t]),p?r.jsx("div",{className:"flex justify-center items-center h-full w-full",children:r.jsx(q,{})}):s&&r.jsx(v,{defaultValues:s,onSubmit:y,isPending:C||!!m,headerTitle:"Alterar cliente",isEdit:!0,resource:"CUSTOMERS",action:"UPDATE"})}function W(){return r.jsx(K,{})}export{W as default};
