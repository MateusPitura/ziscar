import{u as E,c as d,i as f,b as x,x as h,o as v,r as y,d as b,j as g,A as C,e as S,E as N,a as V}from"./index-PgcJxcI8.js";import{f as P}from"./formatInstallment-DqE2nLOC.js";import{E as T}from"./ExpenseForm-Dusil2t4.js";import"./schemas-C0lewGoY.js";import"./useDialog-BsfWsbN7.js";import"./FieldArray-C1k_ciww.js";import"./Section-fM38iLxT.js";import"./PaymentForm-DLD-SIx4.js";import"./Select-B_0mU97I.js";import"./DataField-DBVDlCWD.js";import"./VehicleExpenseHeader-BqGoEUJ6.js";import"./PageHeader-D5LdL7k-.js";import"./useGetVehicleInfo-OupQO6a7.js";import"./formatVehicleCharacteristics-BEECkIz-.js";import"./index-uZ6AJDZL.js";import"./index-h2bqbBtY.js";import"./selectVehicleInfo-Dgkh_0Xk.js";function $({contextHelper:i}){const{safeFetch:n}=E(),t=d(),a=f(),{showSuccessSnackbar:c}=x(),{pathname:r}=h(),{vehicleId:o}=v(),s=y.useMemo(()=>t.getQueryData(["vehicle",o]),[t,o]);async function u({payment:e}){const m=P({installment:e.installment,upfront:e.upfront});await n(`${S}/vehicle-expense`,{method:"POST",body:{vehicleId:o,category:e.category,observations:e.observations,competencyDate:e.competencyDate,description:`Gasto Veículo ${V(s==null?void 0:s.vehicle.plateNumber,"plateNumber")}`,paidTo:N[e.category],installments:m},resource:"VEHICLE_EXPENSE",action:"CREATE"})}const{mutate:p,isPending:l}=b({mutationFn:u,onSuccess:()=>{c({title:"Gasto criado com sucesso"}),a(r.replace("/new","")),t.invalidateQueries({queryKey:["vehicle-expenses"]}),t.invalidateQueries({queryKey:["accounts-payable"]})}});return g.jsx(T,{defaultValues:C,onSubmit:p,isPending:l,headerTitle:"Novo Gasto do Veículo",resource:"VEHICLE_EXPENSE",action:"CREATE",onClose:()=>a(r.replace("/new","")),contextHelper:i})}export{$ as default};
