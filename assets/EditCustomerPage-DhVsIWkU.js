import{a as u,u as g,b as x,i as F,c as P,o as T,f as U,d as j,r as q,j as o,S as N,e as c}from"./index-BZf2WeKU.js";import{s as R,p as b}from"./selectAddressInfo-sK2kOi2R.js";import{u as v}from"./useIsFetching-Ckvpf_4p.js";import{C as w}from"./CustomerForm-B4PdBfEz.js";import"./schemas-uOsodSYq.js";import"./useDialog-Q2f17nT0.js";import"./AddressFields-B9iB5g47.js";import"./FieldArray-F9VSLlp9.js";import"./Section-Bf1M-jgo.js";import"./Select-Brlr1v8A.js";import"./PageHeader-BhNPn7vC.js";import"./index-xiYfcwLl.js";import"./index-4_VLVWB1.js";import"./CustomerFormInputs-BEzoOIj5.js";function K(s){return{fullName:s.fullName,email:s.email??"",phone:u(s.phone,"phone")??"",cpf:u(s.cpf,"cpf")??"",address:R(s.address)}}function J({contextHelper:s}){const{safeFetch:i}=g(),{showSuccessSnackbar:m}=x(),d=v({queryKey:["cepApi"]}),l=F(),r=P(),{customerId:t}=T();async function p(){return await i(`${c}/customer/${t}`,{resource:"CUSTOMERS",action:"READ"})}const{data:e,isFetching:f}=U({queryKey:["customer",t],queryFn:p,select:K});async function y(h){const{address:E,...A}=h,n=b({newAddress:E,oldAddress:e==null?void 0:e.address});await i(`${c}/customer/${t}`,{method:"PATCH",body:{...A,...n&&{address:n}},resource:"CUSTOMERS",action:"UPDATE"})}const{mutate:C,isPending:S,isSuccess:a}=j({mutationFn:y,onSuccess:async()=>{m({title:`Cliente ${e==null?void 0:e.fullName} atualizado com sucesso`}),r.invalidateQueries({queryKey:["customers"]}),l("/customers")}});return q.useEffect(()=>()=>{a&&r.invalidateQueries({queryKey:["customer",t]})},[a,r,t]),f?o.jsx("div",{className:"flex justify-center items-center h-full w-full",children:o.jsx(N,{})}):e&&o.jsx(w,{defaultValues:e,onSubmit:C,isPending:S||!!d,headerTitle:"Alterar cliente",isEdit:!0,resource:"CUSTOMERS",action:"UPDATE",contextHelper:s})}export{J as default};
