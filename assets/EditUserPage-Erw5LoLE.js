import{r as n,j as i,a as l,u as g,b as P,i as A,c as j,n as v,f as C,d as F,S as R,e as m}from"./index-CrVTpVTI.js";import{u as q}from"./useIsFetching-Dh2N-bBa.js";import{U as w}from"./UserForm-C0yrGMfq.js";import{s as I,p as N}from"./parseAddressToUpdate-D-oUqR3S.js";import"./schemas-B7gcU9vp.js";import"./useButtonState-C7TXS9Jx.js";import"./Choice-LKCp7m0f.js";import"./AddressFields-DlZGQI2J.js";import"./FieldArray-DswNorv6.js";import"./Select-CB-6jpCF.js";import"./dialog-Ct9-qcrh.js";import"./PageHeader-DARJqnt5.js";import"./Section-DVwlB0L5.js";import"./Dialog-BHTFXl4K.js";import"./DialogContext-3LqbYYdn.js";import"./index-BEH4ThDo.js";import"./index-CLx72V5J.js";const b=n.createContext(null);function K({children:e}){const[r,a]=n.useState(!1);function u(t){a(t)}const o=n.useMemo(()=>({example:r,handleExample:u}),[r]);return i.jsx(b.Provider,{value:o,children:e})}function T(e){var r;return{fullName:e.fullName,email:e.email,phone:l(e.phone,"phone")??"",cpf:l(e.cpf,"cpf")??"",roleId:((r=e.roleId)==null?void 0:r.toString())??"",address:I(e.address)}}function $(){const{safeFetch:e}=g(),{showSuccessSnackbar:r}=P(),a=q({queryKey:["cepApi"]}),u=A(),o=j(),{userId:t}=v();async function p(){return await e(`${m}/user/${t}`,{resource:"USERS",action:"READ"})}const{data:s,isFetching:f}=C({queryKey:["user",t],queryFn:p,select:T});async function y(U){const{address:x,...h}=U,d=N({newAddress:x,oldAddress:s==null?void 0:s.address});await e(`${m}/user/${t}`,{method:"PATCH",body:{...h,...d&&{address:d}},resource:"USERS",action:"UPDATE"})}const{mutate:E,isPending:S,isSuccess:c}=F({mutationFn:y,onSuccess:async()=>{r({title:`Usuário ${s==null?void 0:s.fullName} atualizado com sucesso`}),o.invalidateQueries({queryKey:["users"]}),u("/users")}});return n.useEffect(()=>()=>{c&&o.invalidateQueries({queryKey:["user",t]})},[c,o,t]),f?i.jsx("div",{className:"flex justify-center items-center h-full w-full",children:i.jsx(R,{})}):s&&i.jsx(w,{defaultValues:s,onSubmit:E,isPending:S||!!a,headerTitle:"Alterar usuário",isEdit:!0,resource:"USERS",action:"UPDATE",allowEditRole:!0})}function ee(){return i.jsx(K,{children:i.jsx($,{})})}export{ee as default};
