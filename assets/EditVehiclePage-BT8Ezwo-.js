import{i as S,u as j,b as V,c as C,o as b,d as y,r as E,j as e,S as F,l,e as P}from"./index-BZf2WeKU.js";import{F as N}from"./schemas-uOsodSYq.js";import{P as T}from"./FieldArray-F9VSLlp9.js";import{P as q}from"./PageHeader-BhNPn7vC.js";import{u as w}from"./useGetVehicleInfo-MNFoQ4GZ.js";import{b as K}from"./index-DNTMxsJy.js";import{s as Q}from"./selectVehicleInfo-Df5V4G0r.js";import{V as A}from"./VehicleTabs-D0HaEhi4.js";import"./useDialog-Q2f17nT0.js";import"./Section-Bf1M-jgo.js";import"./formatVehicleCharacteristics-BEECkIz-.js";import"./index-4_VLVWB1.js";import"./ColorPreview-541wF9q4.js";import"./PaymentForm-DqmJa4eN.js";import"./Select-Brlr1v8A.js";import"./DataField-puxf29Nz.js";import"./Choice-DWzWARJn.js";import"./selectStoresInfo-CABtn-2O.js";import"./Search-DXN2sdgV.js";import"./selectBrandsInfo-VDxn_10s.js";function ie({contextHelper:u}){const r=S(),{safeFetch:n}=j(),{showSuccessSnackbar:m}=V(),t=C(),{vehicleId:a}=b(),{data:i,isFetching:h}=w({select:Q});async function d({characteristics:o,payment:s,vehicle:v}){const x=[...o.commonCharacteristics,...o.newCharacteristics.map(g=>g.description)];await n(`${P}/vehicles/${a}`,{method:"PATCH",body:{...v,characteristics:x,payment:{purchaseDate:s==null?void 0:s.purchaseDate,paidTo:s==null?void 0:s.paidTo}},resource:"VEHICLES",action:"UPDATE"})}const{mutate:p,isPending:f,isSuccess:c}=y({mutationFn:d,onSuccess:()=>{m({title:`Veículo ${i==null?void 0:i.vehicle.plateNumber} atualizado com sucesso`}),r("/vehicles"),t.invalidateQueries({queryKey:["vehicles"]}),t.invalidateQueries({queryKey:["paid-to"]}),t.invalidateQueries({queryKey:["vehicle-model"]})}});return E.useEffect(()=>()=>{c&&t.invalidateQueries({queryKey:["vehicle",a]})},[c,t,a]),h?e.jsx("div",{className:"flex justify-center items-center h-full w-full",children:e.jsx(F,{})}):i&&e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs(N,{onSubmit:p,className:"flex-1 flex flex-col gap-4",schema:K,replaceEmptyStringToNull:!0,defaultValues:{characteristics:i.characteristics,payment:i.payment,vehicle:i.vehicle},children:[e.jsx(q,{title:"Alterar veículo",contextHelper:u}),e.jsx(A,{isEdit:!0,purchaseValue:i.purchaseValue}),e.jsxs(T,{dirty:!0,primaryBtnState:f?"loading":void 0,children:[e.jsx(l,{color:"lightBlue",iconRight:"Save",label:"Salvar",tooltipMessage:"Salvar cadastro"}),e.jsx(l,{color:"red",iconRight:"Close",label:"Cancelar",tooltipMessage:"Cancelar cadastro",onClick:()=>r("/vehicles")})]})]})})}export{ie as default};
