import{u as h,b as v,i as S,c as g,o as C,x as P,f as V,d as b,r as $,j as o,S as j,E as q,e as p}from"./index-BZf2WeKU.js";import{E as A}from"./ExpenseForm-DXjJi0Fg.js";import"./schemas-uOsodSYq.js";import"./useDialog-Q2f17nT0.js";import"./FieldArray-F9VSLlp9.js";import"./Section-Bf1M-jgo.js";import"./PaymentForm-DqmJa4eN.js";import"./Select-Brlr1v8A.js";import"./DataField-puxf29Nz.js";import"./VehicleExpenseHeader-jMYIIaFy.js";import"./PageHeader-BhNPn7vC.js";import"./useGetVehicleInfo-MNFoQ4GZ.js";import"./formatVehicleCharacteristics-BEECkIz-.js";import"./index-DNTMxsJy.js";import"./index-4_VLVWB1.js";import"./selectVehicleInfo-Df5V4G0r.js";function F(s){var i,a;return{payment:{category:s.category,competencyDate:(a=(i=s.competencyDate)==null?void 0:i.split("T"))==null?void 0:a[0],observations:s.observations??"",upfront:[],installment:null}}}function B({contextHelper:s}){const{safeFetch:i}=h(),{showSuccessSnackbar:a}=v(),r=S(),n=g(),{expenseId:e,vehicleId:l}=C(),{pathname:c}=P();async function m(){return await i(`${p}/vehicle-expense/detail/${e}`,{resource:"VEHICLE_EXPENSE",action:"READ"})}const{data:t,isFetching:E}=V({queryKey:["vehicle-expense",e],queryFn:m,select:F});async function y(x){await i(`${p}/vehicle-expense/${e}`,{method:"PATCH",body:x.payment,resource:"VEHICLE_EXPENSE",action:"UPDATE"})}const{mutate:d,isPending:f,isSuccess:u}=b({mutationFn:y,onSuccess:async()=>{t!=null&&t.payment.category&&a({title:`Gasto de ${q[t.payment.category]} atualizado com sucesso`}),n.invalidateQueries({queryKey:["vehicle-expenses",l]}),n.invalidateQueries({queryKey:["accounts-payable"]}),r(c.replace(`/edit/${e}`,""))}});return $.useEffect(()=>()=>{u&&n.invalidateQueries({queryKey:["vehicle-expense",e]})},[u,n,e]),E?o.jsx("div",{className:"flex justify-center items-center h-full w-full",children:o.jsx(j,{})}):t&&o.jsx(A,{defaultValues:t,onSubmit:d,isPending:f,headerTitle:"Alterar Gasto do VeÃ­culo",isEdit:!0,resource:"VEHICLE_EXPENSE",action:"UPDATE",onClose:()=>r(c.replace(`/edit/${e}`,"")),contextHelper:s})}export{B as default};
