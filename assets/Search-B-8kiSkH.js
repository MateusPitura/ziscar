import{r as i,j as s,f as O,l as T}from"./index-CnY9f91V.js";import{u as g}from"./useDialog-DgUnmKfd.js";import{P as v,C as q,S as y}from"./Select-7V9bPDz1.js";import{u as D,I as P,v as $}from"./schemas-CZyi_FYc.js";function A({delay:p=300,initialValue:r=""}={}){const[u,d]=i.useState(r),[o,m]=i.useState(r);return i.useEffect(()=>{const a=setTimeout(()=>{m(u)},p);return()=>{clearTimeout(a)}},[u,p]),{setValue:d,value:o}}function B({options:p,name:r,disabled:u,loading:d=!1,hideErrorLabel:o,label:m,required:a=!1,onChange:n,onSearchChange:c,shouldFilter:I=!0}){const[j,f]=i.useState(!1),{setValue:S}=g();return i.useEffect(()=>{u&&f(!1)},[u]),s.jsxs("label",{className:"flex flex-col",children:[s.jsx(D,{label:m,required:a}),s.jsxs(v,{open:j,onOpenChange:f,children:[s.jsx(P,{name:r,hideErrorLabel:!0,disabled:u,"data-cy":`select-${r}`,autoComplete:!1,onChange:x=>{f(!0),c==null||c(x)}}),s.jsx(v.Trigger,{}),s.jsx(v.Content,{align:"start",className:"!p-2",children:s.jsx(q,{shouldFilter:I,loading:d,options:p,onChange:x=>{n==null||n(x),S(r,x),f(!1)},valueKey:"label"})})]}),o||s.jsx($,{name:r,required:a})]})}function w({fetchCallback:p,name:r,label:u,queryKey:d,onChange:o,required:m,labelKey:a,valueKey:n,descriptionKey:c,select:I,onClickNotFound:j,formatSearch:f,formatNotFound:S,variant:x}){const{value:E,setValue:F}=A(),{data:e,isLoading:L}=O({queryKey:[d,E],queryFn:({queryKey:t})=>p(t[1]),select:I}),M=i.useMemo(()=>e?e==null?void 0:e.map(t=>({label:String(t[a]),value:String(t[n]),description:c?String(t[c]):""})):[],[e,a,n,c]),V=i.useMemo(()=>{if(S)return S(E)},[E]);return x==="autocomplete"?s.jsx(B,{name:r,onSearchChange:t=>{const l=f(t);l&&F(l)},label:u,options:M,shouldFilter:!1,loading:L,required:m,onChange:t=>{const l=e==null?void 0:e.find(b=>String(b[n])===t);o==null||o(l)}}):s.jsx(y,{name:r,onSearchChange:t=>{const l=f(t);l&&F(l)},label:u,options:M,shouldFilter:!1,loading:L,required:m,onChange:t=>{const l=e==null?void 0:e.find(b=>String(b[n])===t);o==null||o(l)},notFound:V&&j&&s.jsx(T,{tooltipMessage:void 0,label:`Cadastrar "${V}"`,variant:"quaternary",onClick:()=>j(V)})})}export{w as S};
