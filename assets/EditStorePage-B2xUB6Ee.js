import{a as c,u as g,b as x,i as F,c as P,o as T,f as q,d as R,r as b,j as o,S as v,e as u}from"./index-BZf2WeKU.js";import{s as w,p as C}from"./selectAddressInfo-sK2kOi2R.js";import{u as K}from"./useIsFetching-Ckvpf_4p.js";import{S as $}from"./StoreForm-BCVJwK3M.js";import"./schemas-uOsodSYq.js";import"./useDialog-Q2f17nT0.js";import"./AddressFields-B9iB5g47.js";import"./FieldArray-F9VSLlp9.js";import"./Section-Bf1M-jgo.js";import"./Select-Brlr1v8A.js";import"./PageHeader-BhNPn7vC.js";import"./index-IuBIpkqU.js";import"./index-4_VLVWB1.js";function I(s){return{name:s.name,email:s.email??"",phone:c(s.phone,"phone")??"",cnpj:c(s.cnpj,"cnpj")??"",address:w(s.address)}}function G({contextHelper:s}){const{safeFetch:a}=g(),{showSuccessSnackbar:d}=x(),m=K({queryKey:["cepApi"]}),p=F(),r=P(),{storeId:t}=T();async function l(){return await a(`${u}/store/${t}`,{resource:"STORES",action:"READ"})}const{data:e,isFetching:f}=q({queryKey:["store",t],queryFn:l,select:I});async function S(E){const{address:j,...A}=E,i=C({newAddress:j,oldAddress:e==null?void 0:e.address});await a(`${u}/store/${t}`,{method:"PATCH",body:{...A,...i&&{address:i}},resource:"STORES",action:"UPDATE"})}const{mutate:y,isPending:h,isSuccess:n}=R({mutationFn:S,onSuccess:async()=>{d({title:`Loja ${e==null?void 0:e.name} atualizada com sucesso`}),r.invalidateQueries({queryKey:["stores"]}),p("/stores")}});return b.useEffect(()=>()=>{n&&r.invalidateQueries({queryKey:["store",t]})},[n,r,t]),f?o.jsx("div",{className:"flex justify-center items-center h-full w-full",children:o.jsx(v,{})}):e&&o.jsx($,{defaultValues:e,onSubmit:y,isPending:h||!!m,headerTitle:"Alterar loja",isEdit:!0,resource:"STORES",action:"UPDATE",contextHelper:s})}export{G as default};
