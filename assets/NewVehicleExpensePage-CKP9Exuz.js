import{u as f,c as y,f as b,b as C,s as S,k as g,r as N,d as V,j as m,x as D,e as P,E as w,a as T,y as I}from"./index-DLLA1f-v.js";import{E as M}from"./ExpenseForm-DzAAaTWe.js";import"./schemas-Bhi0Dh6I.js";import"./useButtonState-3b0McXTU.js";import"./FieldArray-BBhN6Zd9.js";import"./dialog-BH6A_dKB.js";import"./Section-BgbGHRg0.js";import"./PaymentForm-0P3bM2lj.js";import"./DataField-whfLL2N4.js";import"./VehicleExpenseHeader-Dswyw1GN.js";import"./PageHeader-Bs9TDp09.js";import"./selectVehicleInfo-ycdfHdPz.js";import"./index-ORUOFCuk.js";import"./index-2Ad1AATz.js";function j(){const{safeFetch:E}=f(),t=y(),o=b(),{showSuccessSnackbar:d}=C(),{pathname:n}=S(),{vehicleId:s}=g(),a=N.useMemo(()=>t.getQueryData(["vehicle",s]),[t,s]);async function v({payment:e}){var i,r,u,l,c,p;await E(`${P}/vehicles/expense`,{method:"POST",body:{vehicleId:s,category:e.category,observations:e.observations,description:`Gasto Veículo ${T(a==null?void 0:a.vehicle.plateNumber,"plateNumber")}`,paidTo:w[e.category],installments:[{dueDate:(i=e.installment)==null?void 0:i.dueDate,value:(r=e.installment)==null?void 0:r.value,isUpfront:!1,paymentMethods:((u=e.installment)==null?void 0:u.status)===I.PAID?[{type:(l=e.installment)==null?void 0:l.paymentMethod,value:(c=e.installment)==null?void 0:c.value,paymentDate:(p=e.installment)==null?void 0:p.paymentDate}]:null}]},resource:"VEHICLE_EXPENSE",action:"CREATE"})}const{mutate:x,isPending:h}=V({mutationFn:v,onSuccess:()=>{d({title:"Gasto criado com sucesso"}),o(n.replace("/new","")),t.invalidateQueries({queryKey:["vehicle-expenses"]}),t.invalidateQueries({queryKey:["accounts-payable"]})}});return m.jsx(M,{defaultValues:D,onSubmit:x,isPending:h,headerTitle:"Novo Gasto do Veículo",resource:"VEHICLE_EXPENSE",action:"CREATE",onClose:()=>o(n.replace("/new",""))})}function B(){return m.jsx(j,{})}export{B as default};
