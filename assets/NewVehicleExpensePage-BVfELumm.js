import{u as E,c as d,i as f,b as x,w as h,o as v,r as y,d as b,j as g,z as C,e as S,E as N,a as V}from"./index-LO79eavt.js";import{f as w}from"./formatInstallment-wviza060.js";import{E as P}from"./ExpenseForm-BPMvX8iE.js";import"./schemas-C0aL5P6j.js";import"./useDialog-pT-Uqh-i.js";import"./FieldArray-nV10FFMi.js";import"./Section-dk9GDjtF.js";import"./PaymentForm-B-c3y5pd.js";import"./Select-CrTaPVoa.js";import"./DataField-DvGceO3C.js";import"./VehicleExpenseHeader-nSecEM2x.js";import"./PageHeader-C8ixiw9T.js";import"./formatVehicleCharacteristics-BEECkIz-.js";import"./selectVehicleInfo-C2onKQ51.js";import"./index-itdTiU89.js";import"./index-DfarobFx.js";function X({contextHelper:i}){const{safeFetch:n}=E(),t=d(),a=f(),{showSuccessSnackbar:c}=x(),{pathname:r}=h(),{vehicleId:s}=v(),o=y.useMemo(()=>t.getQueryData(["vehicle",s]),[t,s]);async function u({payment:e}){const m=w({installment:e.installment,upfront:e.upfront});await n(`${S}/vehicle-expense`,{method:"POST",body:{vehicleId:s,category:e.category,observations:e.observations,competencyDate:e.competencyDate,description:`Gasto Veículo ${V(o==null?void 0:o.vehicle.plateNumber,"plateNumber")}`,paidTo:N[e.category],installments:m},resource:"VEHICLE_EXPENSE",action:"CREATE"})}const{mutate:p,isPending:l}=b({mutationFn:u,onSuccess:()=>{c({title:"Gasto criado com sucesso"}),a(r.replace("/new","")),t.invalidateQueries({queryKey:["vehicle-expenses"]}),t.invalidateQueries({queryKey:["accounts-payable"]})}});return g.jsx(P,{defaultValues:C,onSubmit:p,isPending:l,headerTitle:"Novo Gasto do Veículo",resource:"VEHICLE_EXPENSE",action:"CREATE",onClose:()=>a(r.replace("/new","")),contextHelper:i})}export{X as default};
