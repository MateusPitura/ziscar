import{u as E,c as d,i as f,b as x,x as h,o as v,r as y,d as b,j as g,A as C,e as S,E as N,a as V}from"./index-BZf2WeKU.js";import{f as P}from"./formatInstallment-Dx1IUn06.js";import{E as T}from"./ExpenseForm-DXjJi0Fg.js";import"./schemas-uOsodSYq.js";import"./useDialog-Q2f17nT0.js";import"./FieldArray-F9VSLlp9.js";import"./Section-Bf1M-jgo.js";import"./PaymentForm-DqmJa4eN.js";import"./Select-Brlr1v8A.js";import"./DataField-puxf29Nz.js";import"./VehicleExpenseHeader-jMYIIaFy.js";import"./PageHeader-BhNPn7vC.js";import"./useGetVehicleInfo-MNFoQ4GZ.js";import"./formatVehicleCharacteristics-BEECkIz-.js";import"./index-DNTMxsJy.js";import"./index-4_VLVWB1.js";import"./selectVehicleInfo-Df5V4G0r.js";function $({contextHelper:i}){const{safeFetch:n}=E(),t=d(),a=f(),{showSuccessSnackbar:c}=x(),{pathname:r}=h(),{vehicleId:o}=v(),s=y.useMemo(()=>t.getQueryData(["vehicle",o]),[t,o]);async function u({payment:e}){const m=P({installment:e.installment,upfront:e.upfront});await n(`${S}/vehicle-expense`,{method:"POST",body:{vehicleId:o,category:e.category,observations:e.observations,competencyDate:e.competencyDate,description:`Gasto Veículo ${V(s==null?void 0:s.vehicle.plateNumber,"plateNumber")}`,paidTo:N[e.category],installments:m},resource:"VEHICLE_EXPENSE",action:"CREATE"})}const{mutate:p,isPending:l}=b({mutationFn:u,onSuccess:()=>{c({title:"Gasto criado com sucesso"}),a(r.replace("/new","")),t.invalidateQueries({queryKey:["vehicle-expenses"]}),t.invalidateQueries({queryKey:["accounts-payable"]})}});return g.jsx(T,{defaultValues:C,onSubmit:p,isPending:l,headerTitle:"Novo Gasto do Veículo",resource:"VEHICLE_EXPENSE",action:"CREATE",onClose:()=>a(r.replace("/new","")),contextHelper:i})}export{$ as default};
