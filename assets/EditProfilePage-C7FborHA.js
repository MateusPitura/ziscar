import{r as l,j as a,v as b,w as E,t as v,x as j,a as F,y as S,p as C,z as m}from"./index-Bk1-U1gT.js";import{u as A,U as q}from"./UserForm-XkM6XIrM.js";import{a as u}from"./index-DIBAWhTZ.js";import{s as M,p as w}from"./parseAddressPayload-DEOBBegZ.js";import"./Choice-D-eKCops.js";import"./useButtonState-B12HSnGx.js";import"./Loading-Dzwhq4Sl.js";import"./Section-BLbuff5n.js";const K=l.createContext(null);function N({children:e}){const[t,i]=l.useState("");function s(n){i(n)}const o=l.useMemo(()=>({example:t,handleExample:s}),[t]);return a.jsx(K.Provider,{value:o,children:e})}function D(e){var t,i,s,o,n,r,c;return{fullName:e.fullName,email:e.email,cellPhone:u(e.cellPhone,"cellphone")??"",cpf:u(e.cpf,"cpf")??"",code:e.code??"",birthDate:e.birthDate?M({date:e.birthDate,format:"yyyy-MM-dd"}):"",address:e.address?{cep:u((t=e.address)==null?void 0:t.cep,"cep")??"",number:((i=e.address)==null?void 0:i.number)??"",street:((s=e.address)==null?void 0:s.street)??"",complement:((o=e.address)==null?void 0:o.complement)??"",neighborhood:((n=e.address)==null?void 0:n.neighborhood)??"",city:((r=e.address)==null?void 0:r.city)??"",state:((c=e.address)==null?void 0:c.state)??""}:null}}function Q(){const{safeFetch:e}=b(),{showSuccessSnackbar:t}=E(),i=v(),s=j(),o=A({queryKey:["cepApi"]});async function n(){return await e(`${m}/profile`)}const{data:r,isFetching:c}=F({queryKey:["profile"],queryFn:n,select:D});async function p(P){const{address:x,...g}=P,f=w({newAddress:x,oldAddress:r==null?void 0:r.address});await e(`${m}/profile`,{method:"PATCH",body:{...g,...f&&{address:f}}})}const{mutate:y,isPending:h,isSuccess:d}=S({mutationFn:p,onSuccess:async()=>{t({title:"Perfil atualizado com sucesso"}),s.invalidateQueries({queryKey:["usersDashboard"]}),i("/profile")}});return l.useEffect(()=>()=>{d&&s.invalidateQueries({queryKey:["profile"]})},[d,s]),c?a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(C,{})}):r&&a.jsx(q,{headerTitle:"Editar informações pessoais",headerPrimaryBtnLabel:"Alterar",defaultValues:r,onSubmit:y,isPending:h||!!o,isEdit:!0})}function $(){return a.jsx(N,{children:a.jsx(Q,{})})}export{$ as default};
