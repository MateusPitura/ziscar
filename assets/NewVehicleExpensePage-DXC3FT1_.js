import{u as E,c as x,l as f,b as d,x as h,p as v,r as y,d as C,j as n,C as b,e as g,E as N,a as S}from"./index-qW6Jgc2x.js";import{f as V}from"./formatInstallment-CXy-wUrH.js";import{E as w}from"./ExpenseForm-PnPGy1Da.js";import"./schemas-DhckABRc.js";import"./useButtonState-D4P9Pwdl.js";import"./FieldArray-B1248Sy6.js";import"./Section--reUab6O.js";import"./PaymentForm-DXcpSWPI.js";import"./Select-C7MuPilF.js";import"./dialog-D5XMW0Vt.js";import"./DataField-ChWFe_Y0.js";import"./VehicleExpenseHeader-Bq74YEj2.js";import"./PageHeader-Duldp10i.js";import"./selectVehicleInfo-BksJfRaS.js";import"./index-CGkwpitV.js";import"./index-CImUiWf5.js";function P(){const{safeFetch:i}=E(),t=x(),a=f(),{showSuccessSnackbar:c}=d(),{pathname:r}=h(),{vehicleId:s}=v(),o=y.useMemo(()=>t.getQueryData(["vehicle",s]),[t,s]);async function u({payment:e}){const m=V({installment:e.installment,upfront:e.upfront});await i(`${g}/vehicle-expense`,{method:"POST",body:{vehicleId:s,category:e.category,observations:e.observations,competencyDate:e.competencyDate,description:`Gasto Veículo ${S(o==null?void 0:o.vehicle.plateNumber,"plateNumber")}`,paidTo:N[e.category],installments:m},resource:"VEHICLE_EXPENSE",action:"CREATE"})}const{mutate:p,isPending:l}=C({mutationFn:u,onSuccess:()=>{c({title:"Gasto criado com sucesso"}),a(r.replace("/new","")),t.invalidateQueries({queryKey:["vehicle-expenses"]}),t.invalidateQueries({queryKey:["accounts-payable"]})}});return n.jsx(w,{defaultValues:b,onSubmit:p,isPending:l,headerTitle:"Novo Gasto do Veículo",resource:"VEHICLE_EXPENSE",action:"CREATE",onClose:()=>a(r.replace("/new",""))})}function X(){return n.jsx(P,{})}export{X as default};
