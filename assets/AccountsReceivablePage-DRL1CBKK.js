import{r as c,j as e,e as v,T as C,f as A,I as d,am as f,g as S}from"./index-CwQymCQa.js";import{P as h}from"./PageHeader-ciO4E3wM.js";import{S as j,T as a}from"./Table-C7F72B_O.js";import{u as m,f as F}from"./react-pdf.browser-IDMxSf8g.js";import{E as D}from"./ExportButton-CPuXLC1o.js";import{b,F as y,u as E,I as p,i as P}from"./schemas-BL4SC9at.js";import{u as g}from"./useDialogContext-CYt-LWKG.js";import{S as I,A as N}from"./AccountStatus-CBmOtPUH.js";import{C as u}from"./Choice-DMQtnXq8.js";import"./DialogContext-qdOZWBM2.js";import"./useIsFetching-DbLUeXt5.js";const R=c.createContext(null);function V({children:t}){const[l,s]=c.useState("");function n(r){s(r)}const i=c.useMemo(()=>({example:l,handleExample:n}),[l]);return e.jsx(R.Provider,{value:i,children:t})}function L(t){const l=[];for(const s of t.data)l.push({...s,totalValue:b(s.totalValue,"money")??""});return{total:t.total,data:l}}function T({accountReceivableId:t}){const l=v();return e.jsx(C,{content:"Visualizar detalhes",children:e.jsx(A,{variant:"quaternary",iconLeft:"Visibility",onClick:()=>l(`/accounts-receivable/installments/${t}`),resource:"ACCOUNTS_RECEIVABLE",action:"READ",padding:"none","data-cy":`button-edit-accountReceivable-${t}`})})}function B(){const{accountsReceivableFilter:t,handleAccountsReceivableFilter:l}=m(),{closeDialog:s}=g();function n(i){l({page:1,...i}),s()}return e.jsx(y,{schema:I,onSubmit:n,className:"flex-1 flex flex-col",defaultValues:{startDate:(t==null?void 0:t.startDate)||"",endDate:(t==null?void 0:t.endDate)||"",overallStatus:(t==null?void 0:t.overallStatus)||d.PAID},replaceEmptyStringToNull:!1,children:e.jsx(H,{})})}function H(){const{reset:t}=E(),{handleAccountsReceivableFilter:l}=m(),{closeDialog:s}=g();function n(){l(f),t(f),s()}return e.jsxs(e.Fragment,{children:[e.jsxs(j.Body,{className:"flex flex-col gap-4",children:[e.jsx(p,{name:"startDate",label:"Data inicial",type:"date"}),e.jsx(p,{name:"endDate",label:"Data final",type:"date"}),e.jsx(P,{label:"Status geral"}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs(u,{hideErrorLabel:!0,children:[e.jsx(u.Radio,{name:"overallStatus",label:"Pago",value:d.PAID}),e.jsx(u.Radio,{name:"overallStatus",label:"Pendente",value:d.PENDING})]})})]}),e.jsx(j.Footer,{primaryLabel:"Aplicar",secondaryLabel:"Limpar",onSecondaryCallback:n,dirty:!0})]})}const q=c.memo(B);function k(t){const l=[];for(const s of t.data)l.push({...s,totalValue:b(s.totalValue,"money")??"",overallStatus:s.overallStatus==="PAID"?"Pago":"Pendente"});return l}function G(){const{accountsReceivableFilter:t,handleAccountsReceivableFilter:l}=m();function s(o){l({page:o})}const n=c.useMemo(()=>t?F(t):"",[t]);async function i(o){return console.log("filter: ",o),{total:3,data:[{id:1,description:"Conta a receber 1",receivedFrom:"Cliente A",totalValue:"10000",overallStatus:"PENDING"},{id:2,description:"Conta a receber 2",receivedFrom:"Cliente B",totalValue:"5000",overallStatus:"PENDING"},{id:3,description:"Conta a receber 3",receivedFrom:"Cliente C",totalValue:"15000",overallStatus:"PAID"}]}}const{data:r,isFetching:x}=S({queryKey:["accounts-receivable",n],queryFn:({queryKey:o})=>i(o[1]),select:L});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-4 justify-end",children:[e.jsx(D,{fileName:"Relatório Contas a Receber",resource:"ACCOUNTS_RECEIVABLE",queryKey:["accounts-receivable",n],queryFn:i,selectQueryFn:k,formatFilters:{endDate:"Data final",startDate:"Data inicial",overallStatus:"Status geral"},formatFiltersValues:{overallStatus:{PAID:"Pago",PENDING:"Pendente"}},formatColumns:{id:"ID",description:"Descrição",receivedFrom:"Recebido de",totalValue:"Valor total",overallStatus:"Status geral"}}),e.jsx(a.Filter,{form:e.jsx(q,{})})]}),e.jsxs(a,{children:[e.jsxs(a.Header,{children:[e.jsx(a.Head,{label:"ID"}),e.jsx(a.Head,{label:"Descrição"}),e.jsx(a.Head,{label:"Recebido de"}),e.jsx(a.Head,{label:"Valor total"}),e.jsx(a.Head,{label:"Status geral"}),e.jsx(a.Head,{action:!0})]}),e.jsx(a.Body,{isLoading:x,isEmpty:!(r!=null&&r.total),resource:"ACCOUNTS_RECEIVABLE",action:"READ",children:r==null?void 0:r.data.map(o=>e.jsxs(a.Row,{children:[e.jsx(a.Cell,{label:String(o.id)}),e.jsx(a.Cell,{label:o.description}),e.jsx(a.Cell,{label:o.receivedFrom}),e.jsx(a.Cell,{label:o.totalValue}),e.jsx(a.Cell,{label:e.jsx(N,{status:o.overallStatus})}),e.jsx(a.Action,{children:e.jsx(T,{accountReceivableId:String(o.id)})})]},o.id))}),e.jsx(a.Footer,{currentStartItem:t==null?void 0:t.page,totalItems:r==null?void 0:r.total,onClickNavigateBtn:s,isLoading:x})]})]})}function M(){return e.jsxs("div",{className:"flex flex-col gap-4 h-full w-full",children:[e.jsx(h,{title:"Contas a Receber"}),e.jsx(G,{})]})}function Y(){return e.jsx(V,{children:e.jsx(M,{})})}export{Y as default};
