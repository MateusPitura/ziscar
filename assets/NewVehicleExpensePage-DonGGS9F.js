import{u as f,c as y,f as b,b as C,t as S,l as g,r as N,d as V,j as m,z as D,e as P,E as w,a as T,A}from"./index-CDuUmDit.js";import{E as I}from"./ExpenseForm-DZM9Vchc.js";import"./schemas-CxmGnStq.js";import"./useButtonState-DJFFoANO.js";import"./FieldArray-Dw98_Trr.js";import"./dialog-3JPZnGOG.js";import"./Section-Dx5LZFIe.js";import"./PaymentForm-BT9tu9Xl.js";import"./DataField-B0EHyytN.js";import"./VehicleExpenseHeader-HhexgJd-.js";import"./PageHeader-B5SIBKuZ.js";import"./selectVehicleInfo-DaknI4Z7.js";import"./index-i8uBxv0L.js";import"./index-Bov_tmPN.js";function M(){const{safeFetch:E}=f(),t=y(),o=b(),{showSuccessSnackbar:d}=C(),{pathname:n}=S(),{vehicleId:s}=g(),a=N.useMemo(()=>t.getQueryData(["vehicle",s]),[t,s]);async function v({payment:e}){var i,r,l,u,c,p;await E(`${P}/vehicles/expense`,{method:"POST",body:{vehicleId:s,category:e.category,observations:e.observations,description:`Gasto Veículo ${T(a==null?void 0:a.vehicle.plateNumber,"plateNumber")}`,paidTo:w[e.category],installments:[{dueDate:(i=e.installment)==null?void 0:i.dueDate,value:(r=e.installment)==null?void 0:r.value,isUpfront:!1,paymentMethods:((l=e.installment)==null?void 0:l.status)===A.PAID?[{type:(u=e.installment)==null?void 0:u.paymentMethod,value:(c=e.installment)==null?void 0:c.value,paymentDate:(p=e.installment)==null?void 0:p.paymentDate}]:null}]},resource:"VEHICLE_EXPENSE",action:"CREATE"})}const{mutate:h,isPending:x}=V({mutationFn:v,onSuccess:()=>{d({title:"Gasto criado com sucesso"}),o(n.replace("/new","")),t.invalidateQueries({queryKey:["vehicle-expenses"]}),t.invalidateQueries({queryKey:["accounts-payable"]})}});return m.jsx(I,{defaultValues:D,onSubmit:h,isPending:x,headerTitle:"Novo Gasto do Veículo",resource:"VEHICLE_EXPENSE",action:"CREATE",onClose:()=>o(n.replace("/new",""))})}function z(){return m.jsx(M,{})}export{z as default};
