import{x as E,r as u,H as S,v,w as F,a as k,j as e,B as f,J as B,T as N,t as A,K as I,L}from"./index-Bk1-U1gT.js";import{I as a,F as q,b as P}from"./index-DIBAWhTZ.js";import{C as j}from"./Choice-D-eKCops.js";import{a as R}from"./useButtonState-B12HSnGx.js";import{P as V}from"./Loading-Dzwhq4Sl.js";import{S as s}from"./Section-BLbuff5n.js";function Q(n,c){const l=E(),o=l.getQueryCache();return u.useSyncExternalStore(u.useCallback(d=>o.subscribe(S.batchCalls(d)),[o]),()=>l.isFetching(n),()=>l.isFetching(n))}function w({defaultOpen:n=!1}){const[c,l]=u.useState(""),[o,d]=u.useState(n),{setValue:r,trigger:x,getValues:p}=R(),{safeFetch:h}=v(),{showErrorSnackbar:m}=F();async function y(){if(await x("address.cep")){const D=p("address.cep");l(D)}}async function b(i){return await h(`https://viacep.com.br/ws/${i}/json/`,{enableCookie:!1})}const{data:t,isFetching:g}=k({queryKey:["cepApi",c],queryFn:({queryKey:i})=>b(i[1]),enabled:!!c});u.useEffect(()=>{if(t!=null&&t.erro){m({description:"CEP não encontrado"});return}t&&(r("address.street",t.logradouro,{shouldDirty:!0}),r("address.neighborhood",t.bairro,{shouldDirty:!0}),r("address.city",t.localidade,{shouldDirty:!0}),r("address.state",t.uf,{shouldDirty:!0}))},[t,r,m]);function C(i){i.key==="Enter"&&(i.preventDefault(),y())}return o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-end col-span-full",children:e.jsx(N,{content:"Remover endereço",children:e.jsx(f,{variant:"tertiary",iconLeft:"Delete",onClick:()=>{d(!1),r("address",null,{shouldDirty:!0})}})})}),e.jsxs("div",{className:"flex items-center justify-between gap-1",onKeyDown:C,children:[e.jsx(a,{label:"CEP",name:"address.cep",mask:"cep",maxLength:9,required:!0,forceUnselect:!0}),e.jsx(f,{variant:"quaternary",label:"Preencher automaticamente",onClick:y,padding:"none",state:g?"loading":void 0})]}),e.jsx(a,{label:"Número",name:"address.number",required:!0}),e.jsx(a,{label:"Rua",name:"address.street"}),e.jsx(a,{label:"Bairro",name:"address.neighborhood"}),e.jsx(a,{label:"Cidade",name:"address.city"}),e.jsx(a,{label:"Estado",name:"address.state"}),e.jsx(a,{label:"Complemento",name:"address.complement"})]}):e.jsx("div",{className:"col-span-full",children:e.jsx(f,{variant:"secondary",label:"Adicionar endereço",onClick:()=>{d(!0),r("address",B,{shouldDirty:!0})},fullWidth:!0,textAlign:"center"})})}const O=-1;function T({defaultValues:n,onSubmit:c,isPending:l,headerPrimaryBtnLabel:o,headerTitle:d,isEdit:r=!1,resource:x,action:p,allowEditRole:h=!1}){const m=A();return e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs(q,{schema:P,defaultValues:n,onSubmit:c,className:"gap-4 flex flex-col",onlyDirty:r,children:[e.jsx(V,{title:d,primaryButtonLabel:o,secondaryButtonLabel:"Cancelar",onClickSecondaryBtn:()=>m(O),primaryBtnState:l?"loading":void 0,dirty:!0,primaryBtnResource:x,primaryBtnAction:p}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(s,{children:[e.jsx(s.Title,{title:"Informações pessoais"}),e.jsxs(s.Group,{children:[e.jsx(s.Header,{title:"Dados"}),e.jsxs(s.Body,{children:[e.jsx(a,{name:"fullName",label:"Nome completo",required:!0,autoFocus:!0}),e.jsx(a,{name:"email",label:"Email",required:!0,disabled:r,type:"email"}),e.jsx(a,{name:"cellPhone",label:"Celular",mask:"cellphone",maxLength:15,type:"tel"}),e.jsx(a,{name:"cpf",label:"CPF",mask:"cpf",maxLength:14}),e.jsx(a,{name:"code",label:"Matrícula"}),e.jsx(a,{name:"birthDate",label:"Data de nascimento",type:"date"})]})]}),e.jsxs(s.Group,{children:[e.jsx(s.Header,{title:"Endereço"}),e.jsx(s.Body,{children:e.jsx(w,{defaultOpen:!!n.address})})]}),h&&e.jsxs(s.Group,{children:[e.jsx(s.Header,{title:"Categoria"}),e.jsx(s.Body,{children:e.jsxs(j,{name:"roleId",children:[e.jsx(j.Radio,{label:"Administrador",value:I}),e.jsx(j.Radio,{label:"Vendedor",value:L})]})})]})]})})]})})}export{T as U,Q as u};
