import{a4 as h,j as e,T as p,B as f,h as b,S as A,aa as c,c as D,d as v,e as C,ab as R,ac as d,k as E,r as g,a as P}from"./index-B_iWEUUC.js";import{P as S}from"./PageHeader-DfUmqkU2.js";import{T as t}from"./Table-D_1FooX_.js";import{a as I,A as T}from"./AccountStatus-DjCqv6K5.js";import{a as M,F as q,I as N,b as B}from"./schemas-D1jfyf81.js";import{u as F}from"./useDialog-C-b4l8WV.js";import{D as u}from"./Dialog-CGi7XIRs.js";import{D as j}from"./DataField-DHqCUUGv.js";import{C as r}from"./Choice-B-eajStn.js";function L(a){const s=[];for(const i of a)s.push({...i,dueDate:h({date:i.dueDate,format:"dd/MM/yyyy"})??"",value:M(i.value,"money")??""});return s}function H({installment:a,handleInstallmentToPaymentMethodInfo:s}){return a.status==="PAID"?e.jsx(p,{content:"Visualizar mÃ©todo de pagamento",children:e.jsx(f,{variant:"quaternary",iconLeft:"Receipt",onClick:()=>s(a),resource:"ACCOUNTS_RECEIVABLE",action:"UPDATE",padding:"none","data-cy":`button-edit-viewPaymentMethod-${a.id}`})}):e.jsx(p,{content:"Adicionar mÃ©todo de pagamento",children:e.jsx(f,{variant:"quaternary",iconLeft:"AddCard",onClick:()=>s(a),resource:"ACCOUNTS_RECEIVABLE",action:"READ",padding:"none","data-cy":`button-edit-addPaymentMethod-${a.id}`})})}function V(a){return{...a,paymentDate:h({date:a.paymentDate,format:"dd/MM/yyyy"})??""}}function _({installment:a,...s}){async function i(){return{id:1,paymentDate:"2025-01-01",type:"CREDIT_CARD"}}const{data:n,isFetching:m}=b({queryKey:["accounts-receivable-payment-method",a.id],queryFn:i,select:V});return e.jsxs(u,{...s,children:[e.jsx(u.Header,{title:"Detalhes do MÃ©todo de Pagamento"}),e.jsx(u.Body,{children:e.jsx("div",{className:"flex flex-col gap-4 h-36 mb-8",children:m?e.jsx("div",{className:"flex justify-center items-center h-full w-full",children:e.jsx(A,{})}):e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Data do pagamento",value:n==null?void 0:n.paymentDate}),e.jsx(j,{label:"Forma de pagamento",value:n&&c[n==null?void 0:n.type]})]})})})]})}function U({installment:a,...s}){const{showSuccessSnackbar:i}=D(),n=v();async function m(y){console.log("ðŸŒ  data: ",y)}const{mutate:x,isPending:o}=C({mutationFn:m,onSuccess:()=>{i({title:"MÃ©todo de pagamento adicionado"}),n.invalidateQueries({queryKey:["accounts-receivable-installments",a.id]}),n.invalidateQueries({queryKey:["accounts-receivable-payment-method",a.id]}),n.invalidateQueries({queryKey:["accounts-receivable"]}),s.closeDialog()}});return e.jsxs(u,{...s,children:[e.jsx(u.Header,{title:"Adicionar MÃ©todo de Pagamento"}),e.jsx(u.Body,{children:e.jsxs(q,{schema:I,defaultValues:R,onSubmit:x,className:"flex flex-col gap-4",children:[e.jsx(N,{name:"paymentDate",label:"Data do pagamento",required:!0,type:"date"}),e.jsx(B,{label:"Forma de pagamento",required:!0}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs(r,{required:!0,children:[e.jsx(r.Radio,{label:c.BANK_SLIP,name:"type",value:d.BANK_SLIP}),e.jsx(r.Radio,{label:c.CREDIT_CARD,name:"type",value:d.CREDIT_CARD}),e.jsx(r.Radio,{label:c.DEBIT_CARD,name:"type",value:d.DEBIT_CARD}),e.jsx(r.Radio,{label:c.CASH,name:"type",value:d.CASH}),e.jsx(r.Radio,{label:c.DOC,name:"type",value:d.DOC}),e.jsx(r.Radio,{label:c.PIX,name:"type",value:d.PIX}),e.jsx(r.Radio,{label:c.TED,name:"type",value:d.TED}),e.jsx(r.Radio,{label:c.TRANSFER,name:"type",value:d.TRANSFER})]})}),e.jsx(u.Footer,{labelPrimaryBtn:"Adicionar",className:"px-0",dirty:!1,primaryBtnState:o?"loading":void 0,primaryBtnResource:"ACCOUNTS_RECEIVABLE",primaryBtnAction:"DELETE"})]})})]})}function k({installment:a,...s}){if(a)return a.status==="PAID"?e.jsx(_,{installment:a,...s}):e.jsx(U,{installment:a,...s})}function w(){const{accountReceivableId:a}=E(),[s,i]=g.useState(null),n=F();function m(l){n.openDialog(),i(l)}async function x(){return[{id:1,dueDate:"2025-01-01",installmentSequence:0,status:"PAID",value:"10000",isRefund:!1,isUpfront:!0},{id:2,dueDate:"2025-01-01",installmentSequence:1,status:"PAID",value:"10000",isRefund:!1,isUpfront:!1},{id:3,dueDate:"2025-02-01",installmentSequence:2,status:"PENDING",value:"10000",isRefund:!1,isUpfront:!1},{id:4,dueDate:"2025-03-01",installmentSequence:3,status:"PENDING",value:"10000",isRefund:!1,isUpfront:!1}]}const{data:o,isFetching:y}=b({queryKey:["accounts-receivable-installments",a],queryFn:x,select:L});return e.jsxs(e.Fragment,{children:[e.jsx(k,{installment:s,...n}),e.jsxs(t,{children:[e.jsxs(t.Header,{children:[e.jsx(t.Head,{label:"ID"}),e.jsx(t.Head,{label:"SequÃªncia"}),e.jsx(t.Head,{label:"Vencimento"}),e.jsx(t.Head,{label:"Valor"}),e.jsx(t.Head,{label:"Status"}),e.jsx(t.Head,{action:!0})]}),e.jsx(t.Body,{isLoading:y,isEmpty:!(o!=null&&o.length),resource:"ACCOUNTS_RECEIVABLE",action:"READ",children:o==null?void 0:o.map(l=>e.jsxs(t.Row,{children:[e.jsx(t.Cell,{label:String(l.id)}),e.jsx(t.Cell,{label:l.isUpfront?"Entrada":`${l.installmentSequence}/${o==null?void 0:o.length}`}),e.jsx(t.Cell,{label:l.dueDate}),e.jsx(t.Cell,{label:l.value}),e.jsx(t.Cell,{label:e.jsx(T,{status:l.status})}),e.jsx(t.Action,{children:e.jsx(H,{installment:l,handleInstallmentToPaymentMethodInfo:m})})]},l.id))})]})]})}function K(){const a=P();return e.jsxs("div",{className:"flex flex-col gap-4 h-full w-full",children:[e.jsx(S,{title:"Detalhes da Conta a Receber",children:e.jsx(f,{variant:"quaternary",label:"Voltar",iconLeft:"ArrowBack",onClick:()=>a("/accounts-receivable"),action:"READ",resource:"ACCOUNTS_RECEIVABLE"})}),e.jsx(w,{})]})}function Z(){return e.jsx(K,{})}export{Z as default};
