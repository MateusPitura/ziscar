import{b as A,c as g,a as x,d as F,k as P,h as T,e as j,r as U,j as r,S as q,f as i}from"./index-B_iWEUUC.js";import{u as N}from"./useIsFetching-DqnnrfEG.js";import{s as R,p as b}from"./parseAddressToUpdate-BhV3BZpB.js";import{C as v}from"./CustomerForm-MDzkkhi_.js";import{a as u}from"./schemas-D1jfyf81.js";import"./index-BpOXT6va.js";import"./index-CS_UDAGd.js";import"./PageHeader-DfUmqkU2.js";import"./PageFooter-CsJslnfg.js";import"./AddressFields-YumhuKEd.js";import"./CustomerFormInputs-XzS-nuGA.js";function w(e){return{fullName:e.fullName,email:e.email??"",phone:u(e.phone,"phone")??"",cpf:u(e.cpf,"cpf")??"",address:R(e.address)}}function K(){const{safeFetch:e}=A(),{showSuccessSnackbar:c}=g(),m=N({queryKey:["cepApi"]}),d=x(),o=F(),{customerId:t}=P();async function l(){return await e(`${i}/customer/${t}`,{resource:"CUSTOMERS",action:"READ"})}const{data:s,isFetching:f}=T({queryKey:["customer",t],queryFn:l,select:w});async function p(S){const{address:h,...E}=S,a=b({newAddress:h,oldAddress:s==null?void 0:s.address});await e(`${i}/customer/${t}`,{method:"PATCH",body:{...E,...a&&{address:a}},resource:"CUSTOMERS",action:"UPDATE"})}const{mutate:y,isPending:C,isSuccess:n}=j({mutationFn:p,onSuccess:async()=>{c({title:`Cliente ${s==null?void 0:s.fullName} atualizado com sucesso`}),o.invalidateQueries({queryKey:["customers"]}),d("/customers")}});return U.useEffect(()=>()=>{n&&o.invalidateQueries({queryKey:["customer",t]})},[n,o,t]),f?r.jsx("div",{className:"flex justify-center items-center h-full w-full",children:r.jsx(q,{})}):s&&r.jsx(v,{defaultValues:s,onSubmit:y,isPending:C||!!m,headerTitle:"Alterar cliente",isEdit:!0,resource:"CUSTOMERS",action:"UPDATE"})}function V(){return r.jsx(K,{})}export{V as default};
