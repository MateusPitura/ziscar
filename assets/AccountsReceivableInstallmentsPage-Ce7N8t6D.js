import{a3 as p,j as e,T as f,B as y,h,S as A,a9 as c,c as D,d as b,e as C,aa as v,k as R,r as E,a as g}from"./index-BC9ZHEaH.js";import{P}from"./PageHeader-rTjd1jJN.js";import{T as t}from"./Table-DbNoA5vL.js";import{a as S,A as I}from"./AccountStatus-ab7TJMxo.js";import{a as T,F as M,I as q,b as N}from"./schemas-B-PX8buY.js";import{u as B}from"./useDialog-CBLU7LHA.js";import{D as d}from"./Dialog-Ckn3MP47.js";import{D as j}from"./DataField-C0ezOIHd.js";import{C as r}from"./Choice-BLT_7Chm.js";function F(a){const s=[];for(const i of a)s.push({...i,dueDate:p({date:i.dueDate,format:"dd/MM/yyyy"})??"",value:T(i.value,"money")??""});return s}function L({installment:a,handleInstallmentToPaymentMethodInfo:s}){return a.status==="PAID"?e.jsx(f,{content:"Visualizar mÃ©todo de pagamento",children:e.jsx(y,{variant:"quaternary",iconLeft:"Receipt",onClick:()=>s(a),resource:"ACCOUNTS_RECEIVABLE",action:"UPDATE",padding:"none","data-cy":`button-edit-viewPaymentMethod-${a.id}`})}):e.jsx(f,{content:"Adicionar mÃ©todo de pagamento",children:e.jsx(y,{variant:"quaternary",iconLeft:"AddCard",onClick:()=>s(a),resource:"ACCOUNTS_RECEIVABLE",action:"READ",padding:"none","data-cy":`button-edit-addPaymentMethod-${a.id}`})})}function H(a){return{...a,paymentDate:p({date:a.paymentDate,format:"dd/MM/yyyy"})??""}}function V({installment:a,...s}){async function i(){return{id:1,paymentDate:"2025-01-01",type:"CREDIT_CARD"}}const{data:n,isFetching:u}=h({queryKey:["accounts-receivable-payment-method",a.id],queryFn:i,select:H});return e.jsxs(d,{...s,children:[e.jsx(d.Header,{title:"Detalhes do MÃ©todo de Pagamento"}),e.jsx(d.Body,{children:e.jsx("div",{className:"flex flex-col gap-4 h-36 mb-8",children:u?e.jsx("div",{className:"flex justify-center items-center h-full w-full",children:e.jsx(A,{})}):e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Data do pagamento",value:n==null?void 0:n.paymentDate}),e.jsx(j,{label:"Forma de pagamento",value:n&&c[n==null?void 0:n.type]})]})})})]})}function _({installment:a,...s}){const{showSuccessSnackbar:i}=D(),n=b();async function u(x){console.log("ðŸŒ  data: ",x)}const{mutate:m,isPending:o}=C({mutationFn:u,onSuccess:()=>{i({title:"MÃ©todo de pagamento adicionado"}),n.invalidateQueries({queryKey:["accounts-receivable-installments",a.id]}),n.invalidateQueries({queryKey:["accounts-receivable-payment-method",a.id]}),n.invalidateQueries({queryKey:["accounts-receivable"]}),s.closeDialog()}});return e.jsxs(d,{...s,children:[e.jsx(d.Header,{title:"Adicionar MÃ©todo de Pagamento"}),e.jsx(d.Body,{children:e.jsxs(M,{schema:S,defaultValues:v,onSubmit:m,className:"flex flex-col gap-4",children:[e.jsx(q,{name:"paymentDate",label:"Data do pagamento",required:!0,type:"date"}),e.jsx(N,{label:"Forma de pagamento",required:!0}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs(r,{required:!0,children:[e.jsx(r.Radio,{label:c.BANK_SLIP,name:"type",value:"BANK_SLIP"}),e.jsx(r.Radio,{label:c.CREDIT_CARD,name:"type",value:"CREDIT_CARD"}),e.jsx(r.Radio,{label:c.DEBIT_CARD,name:"type",value:"DEBIT_CARD"}),e.jsx(r.Radio,{label:c.CASH,name:"type",value:"CASH"}),e.jsx(r.Radio,{label:c.DOC,name:"type",value:"DOC"}),e.jsx(r.Radio,{label:c.PIX,name:"type",value:"PIX"}),e.jsx(r.Radio,{label:c.TED,name:"type",value:"TED"}),e.jsx(r.Radio,{label:c.TRANSFER,name:"type",value:"TRANSFER"})]})}),e.jsx(d.Footer,{labelPrimaryBtn:"Adicionar",className:"px-0",dirty:!1,primaryBtnState:o?"loading":void 0,primaryBtnResource:"ACCOUNTS_RECEIVABLE",primaryBtnAction:"DELETE"})]})})]})}function U({installment:a,...s}){if(a)return a.status==="PAID"?e.jsx(V,{installment:a,...s}):e.jsx(_,{installment:a,...s})}function k(){const{accountReceivableId:a}=R(),[s,i]=E.useState(null),n=B();function u(l){n.openDialog(),i(l)}async function m(){return[{id:1,dueDate:"2025-01-01",installmentSequence:0,status:"PAID",value:"10000",isRefund:!1,isUpfront:!0},{id:2,dueDate:"2025-01-01",installmentSequence:1,status:"PAID",value:"10000",isRefund:!1,isUpfront:!1},{id:3,dueDate:"2025-02-01",installmentSequence:2,status:"PENDING",value:"10000",isRefund:!1,isUpfront:!1},{id:4,dueDate:"2025-03-01",installmentSequence:3,status:"PENDING",value:"10000",isRefund:!1,isUpfront:!1}]}const{data:o,isFetching:x}=h({queryKey:["accounts-receivable-installments",a],queryFn:m,select:F});return e.jsxs(e.Fragment,{children:[e.jsx(U,{installment:s,...n}),e.jsxs(t,{children:[e.jsxs(t.Header,{children:[e.jsx(t.Head,{label:"ID"}),e.jsx(t.Head,{label:"SequÃªncia"}),e.jsx(t.Head,{label:"Vencimento"}),e.jsx(t.Head,{label:"Valor"}),e.jsx(t.Head,{label:"Status"}),e.jsx(t.Head,{action:!0})]}),e.jsx(t.Body,{isLoading:x,isEmpty:!(o!=null&&o.length),resource:"ACCOUNTS_RECEIVABLE",action:"READ",children:o==null?void 0:o.map(l=>e.jsxs(t.Row,{children:[e.jsx(t.Cell,{label:String(l.id)}),e.jsx(t.Cell,{label:l.isUpfront?"Entrada":`${l.installmentSequence}/${o==null?void 0:o.length}`}),e.jsx(t.Cell,{label:l.dueDate}),e.jsx(t.Cell,{label:l.value}),e.jsx(t.Cell,{label:e.jsx(I,{status:l.status})}),e.jsx(t.Action,{children:e.jsx(L,{installment:l,handleInstallmentToPaymentMethodInfo:u})})]},l.id))})]})]})}function w(){const a=g();return e.jsxs("div",{className:"flex flex-col gap-4 h-full w-full",children:[e.jsx(P,{title:"Detalhes da Conta a Receber",children:e.jsx(y,{variant:"quaternary",label:"Voltar",iconLeft:"ArrowBack",onClick:()=>a("/accounts-receivable"),action:"READ",resource:"ACCOUNTS_RECEIVABLE"})}),e.jsx(k,{})]})}function Y(){return e.jsx(w,{})}export{Y as default};
