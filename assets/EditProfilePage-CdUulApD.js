import{r as u,j as i,h as x,i as g,k as b,o as E,l as j,S as C,m as f}from"./index-aVBDU0Ve.js";import{u as F,U as S}from"./UserForm-DqhVntOB.js";import{f as l}from"./Dialog-DJzmwurf.js";import{s as w,p as v}from"./parseAddressPayload-DEOBBegZ.js";import"./Choice-CQV22enN.js";const A=u.createContext(null);function M({children:e}){const[r,t]=u.useState("");function n(s){t(s)}const o=u.useMemo(()=>({example:r,handleExample:n}),[r]);return i.jsx(A.Provider,{value:o,children:e})}function q(e){var r,t,n,o,s,a,c;return{fullName:e.fullName,email:e.email,cellPhone:l(e.cellPhone,"cellphone")??"",cpf:l(e.cpf,"cpf")??"",code:e.code??"",birthDate:e.birthDate?w({date:e.birthDate,format:"yyyy-MM-dd"}):"",address:e.address?{cep:l((r=e.address)==null?void 0:r.cep,"cep")??"",number:((t=e.address)==null?void 0:t.number)??"",street:((n=e.address)==null?void 0:n.street)??"",complement:((o=e.address)==null?void 0:o.complement)??"",neighborhood:((s=e.address)==null?void 0:s.neighborhood)??"",city:((a=e.address)==null?void 0:a.city)??"",state:((c=e.address)==null?void 0:c.state)??""}:null}}function k(){const{safeFetch:e}=x(),{showSuccessSnackbar:r}=g(),t=b(),n=F({queryKey:["cepApi"]});async function o(){return await e(`${f}/profile`)}const{data:s,isFetching:a}=E({queryKey:["profile"],queryFn:o,select:q});async function c(h){const{address:y,...P}=h,d=v({newAddress:y,oldAddress:s==null?void 0:s.address});await e(`${f}/profile`,{method:"PATCH",body:{...P,...d&&{address:d}}})}const{mutate:m,isPending:p}=j({mutationFn:c,onSuccess:async()=>{r({title:"Perfil atualizado com sucesso"}),t.invalidateQueries({queryKey:["profile"]})}});return a?i.jsx("div",{className:"flex justify-center items-center h-full w-full",children:i.jsx(C,{})}):s&&i.jsx(S,{headerTitle:"Editar minha conta",defaultValues:s,onSubmit:m,isPending:p||!!n,isEdit:!0,allowChangePassword:!0})}function Q(){return i.jsx(M,{children:i.jsx(k,{})})}export{Q as default};
