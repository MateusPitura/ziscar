import{f as p,u as y,b as A,c as v,l as F,h as x,d as V,r as g,j as e,S,g as c,e as j,F as E,m as C,n as P}from"./index-CDuUmDit.js";import{F as b}from"./schemas-CxmGnStq.js";import{P as N}from"./FieldArray-Dw98_Trr.js";import{P as T}from"./PageHeader-B5SIBKuZ.js";import{a as B}from"./index-i8uBxv0L.js";import{s as D}from"./selectVehicleInfo-DaknI4Z7.js";import{V as R}from"./VehicleTabs-BKd6R2mm.js";import"./useButtonState-DJFFoANO.js";import"./dialog-3JPZnGOG.js";import"./index-Bov_tmPN.js";import"./Tabs-CSWa71lB.js";import"./Section-Dx5LZFIe.js";import"./PaymentForm-BT9tu9Xl.js";import"./DataField-B0EHyytN.js";import"./Choice-D6VCytWq.js";import"./ColorPreview-DSolxp2X.js";import"./selectStoresInfo-BWzt33a7.js";function k(){const t=p(),{safeFetch:o}=y(),{showSuccessSnackbar:l}=A(),s=v(),{vehicleId:i}=F();async function n(){return{payment:{purchaseDate:"2023-01-01",paidTo:"Fulano de Tal",value:"7000000"},vehicle:{id:1,modelName:"Fusca",announcedPrice:8e6,plateNumber:"ABC1234",modelYear:1970,status:P.DELIVERED,archivedAt:void 0,brand:{id:10,name:"Volkswagen"},store:{id:1,name:"Loja 1"},category:C.CAR,color:"#FFFFFF",chassiNumber:"AAAAAAAAAAAAAAAAA",commissionValue:1e3,fuelType:E.FLEX,kilometers:1e3,minimumPrice:8e6,yearOfManufacture:1970,characteristics:["Direção hidráulica","Janelas elétricas","Ar condicionado","Piloto automático","Vidros elétricos","Freios ABS"]}}}const{data:a,isFetching:u}=x({queryKey:["vehicle",i],queryFn:n,select:D});async function m(f){await o(`${j}/vehicles/${i}`,{method:"PATCH",body:f.vehicle,resource:"VEHICLES",action:"UPDATE"})}const{mutate:h,isPending:d,isSuccess:r}=V({mutationFn:m,onSuccess:()=>{l({title:`Veículo ${a==null?void 0:a.vehicle.modelName} atualizado com sucesso`}),t("/vehicles"),s.invalidateQueries({queryKey:["vehicles"]})}});return g.useEffect(()=>()=>{r&&s.invalidateQueries({queryKey:["vehicle",i]})},[r,s,i]),u?e.jsx("div",{className:"flex justify-center items-center h-full w-full",children:e.jsx(S,{})}):a&&e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs(b,{onSubmit:h,className:"flex-1 flex flex-col gap-4",schema:B,onlyDirty:!0,defaultValues:{characteristics:a.characteristics,payment:a.payment,vehicle:a.vehicle},children:[e.jsx(T,{title:"Alterar veículo"}),e.jsx(R,{isEdit:!0,purchaseValue:a.purchaseValue}),e.jsxs(N,{dirty:!0,primaryBtnState:d?"loading":void 0,children:[e.jsx(c,{color:"lightBlue",iconRight:"Save",label:"Salvar"}),e.jsx(c,{color:"red",iconRight:"Close",label:"Cancelar",onClick:()=>t("/vehicles")})]})]})})}function W(){return e.jsx(k,{})}export{W as default};
