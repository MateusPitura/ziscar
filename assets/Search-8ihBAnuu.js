import{r as d,j as e,S as h,f as L,l as M}from"./index-LO79eavt.js";import{P as E,C as O,a as T,b as $,c as g,S as q}from"./Select-CrTaPVoa.js";import{u as D}from"./useDialog-pT-Uqh-i.js";import{u as P,I as k,v as w}from"./schemas-C0aL5P6j.js";function A({delay:f=300,initialValue:l=""}={}){const[a,j]=d.useState(l),[u,x]=d.useState(l);return d.useEffect(()=>{const o=setTimeout(()=>{x(a)},f);return()=>{clearTimeout(o)}},[a,f]),{setValue:j,value:u}}function B({options:f,name:l,disabled:a,loading:j=!1,hideErrorLabel:u,label:x,required:o=!1,onChange:c,onSearchChange:i,shouldFilter:v=!0}){const[S,m]=d.useState(!1),{setValue:b}=D();return d.useEffect(()=>{a&&m(!1)},[a]),e.jsxs("label",{className:"flex flex-col",children:[e.jsx(P,{label:x,required:o}),e.jsxs(E,{open:S,onOpenChange:m,children:[e.jsx(k,{name:l,hideErrorLabel:!0,disabled:a,"data-cy":`select-${l}`,onChange:s=>{m(!0),i==null||i(s)},autoComplete:!1}),e.jsx(E.Trigger,{}),e.jsx(E.Content,{align:"start",className:"!p-2",children:e.jsx(O,{shouldFilter:v,children:e.jsx(T,{children:j?e.jsx("div",{className:"flex items-center justify-center p-2",children:e.jsx(h,{})}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"text-neutral-700 flex items-center justify-center p-2 text-body-medium min-h-14",children:"Nenhum item encontrado"}),f.map(s=>e.jsx(g,{value:s.label,"data-cy":`select-option-${s.value}`,onSelect:p=>{c==null||c(p),b(l,p),m(!1)},className:"flex !text-neutral-700 text-body-medium",keywords:[s.label],children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{children:s.label}),s.description&&e.jsx("p",{className:"text-label-medium text-neutral-500",children:s.description})]})},s.value))]})})})})]}),u||e.jsx(w,{name:l,required:o})]})}function H({fetchCallback:f,name:l,label:a,queryKey:j,onChange:u,required:x,labelKey:o,valueKey:c,descriptionKey:i,select:v,onClickNotFound:S,formatSearch:m,formatNotFound:b,variant:s}){const{value:p,setValue:N}=A(),{data:r,isLoading:F}=L({queryKey:[j,p],queryFn:({queryKey:t})=>f(t[1]),select:v}),V=d.useMemo(()=>r?r==null?void 0:r.map(t=>({label:String(t[o]),value:String(t[c]),description:i?String(t[i]):""})):[],[r,o,c,i]),y=d.useMemo(()=>{if(b)return b(p)},[p]);return s==="autocomplete"?e.jsx(B,{name:l,onSearchChange:t=>{const n=m(t);n&&N(n)},label:a,options:V,shouldFilter:!1,loading:F,required:x,onChange:t=>{const n=r==null?void 0:r.find(I=>String(I[c])===t);u==null||u(n)}}):e.jsx(q,{name:l,onSearchChange:t=>{const n=m(t);n&&N(n)},label:a,options:V,shouldFilter:!1,loading:F,required:x,onChange:t=>{const n=r==null?void 0:r.find(I=>String(I[c])===t);u==null||u(n)},notFound:y&&S&&e.jsx(M,{tooltipMessage:void 0,label:`Cadastrar "${y}"`,variant:"quaternary",onClick:()=>S(y)})})}export{H as S};
