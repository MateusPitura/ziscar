import{u as x,b as h,i as v,c as S,n as g,w as C,f as V,d as P,r as b,j as r,S as j,E as $,e as u}from"./index-C8Hi2I9-.js";import{E as q}from"./ExpenseForm-DdCCbplx.js";import"./schemas-ARZMo_di.js";import"./useButtonState-D8nv53KZ.js";import"./FieldArray-CybTVLLQ.js";import"./Section-BPNV-L4z.js";import"./PaymentForm-7RTJENqF.js";import"./Select-DaT4dAtZ.js";import"./dialog-DBF6ydzz.js";import"./DataField-CDqrsgkO.js";import"./VehicleExpenseHeader-DqogTx2-.js";import"./PageHeader-C3bsmlao.js";import"./selectVehicleInfo-6C27XIza.js";import"./index-CziveuU3.js";import"./index-Bn3msv5N.js";function A(t){var i,n;return{payment:{category:t.category,competencyDate:(n=(i=t.competencyDate)==null?void 0:i.split("T"))==null?void 0:n[0],observations:t.observations??"",upfront:[],installment:null}}}function F(){const{safeFetch:t}=x(),{showSuccessSnackbar:i}=h(),n=v(),a=S(),{expenseId:e,vehicleId:p}=g(),{pathname:o}=C();async function l(){return await t(`${u}/vehicle-expense/detail/${e}`,{resource:"VEHICLE_EXPENSE",action:"READ"})}const{data:s,isFetching:m}=V({queryKey:["vehicle-expense",e],queryFn:l,select:A});async function E(f){await t(`${u}/vehicle-expense/${e}`,{method:"PATCH",body:f.payment,resource:"VEHICLE_EXPENSE",action:"UPDATE"})}const{mutate:y,isPending:d,isSuccess:c}=P({mutationFn:E,onSuccess:async()=>{s!=null&&s.payment.category&&i({title:`Gasto de ${$[s.payment.category]} atualizado com sucesso`}),a.invalidateQueries({queryKey:["vehicle-expenses",p]}),a.invalidateQueries({queryKey:["accounts-payable"]}),n(o.replace(`/edit/${e}`,""))}});return b.useEffect(()=>()=>{c&&a.invalidateQueries({queryKey:["vehicle-expense",e]})},[c,a,e]),m?r.jsx("div",{className:"flex justify-center items-center h-full w-full",children:r.jsx(j,{})}):s&&r.jsx(q,{defaultValues:s,onSubmit:y,isPending:d,headerTitle:"Alterar Gasto do VeÃ­culo",isEdit:!0,resource:"VEHICLE_EXPENSE",action:"UPDATE",onClose:()=>n(o.replace(`/edit/${e}`,""))})}function z(){return r.jsx(F,{})}export{z as default};
