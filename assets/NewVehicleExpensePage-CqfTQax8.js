import{u as E,c as d,i as f,b as x,x as h,o as v,r as y,d as b,j as g,A as C,e as S,E as N,a as V}from"./index-BaodxefT.js";import{f as P}from"./formatInstallment-Di4IoumH.js";import{E as T}from"./ExpenseForm-h6A6mwqe.js";import"./schemas-C9qoDM_Y.js";import"./useDialog-B00w_pfZ.js";import"./FieldArray-DtKa32ag.js";import"./Section-Cn7yCL_l.js";import"./PaymentForm-Oq_5TN7U.js";import"./Select-JHn8gkD0.js";import"./DataField-ClarmWOb.js";import"./VehicleExpenseHeader-Br2wyGu2.js";import"./PageHeader-BvWMz3kB.js";import"./useGetVehicleInfo-DbygBEfI.js";import"./formatVehicleCharacteristics-BEECkIz-.js";import"./index-DAIKlHgI.js";import"./index-CZBX8443.js";import"./selectVehicleInfo-CI4Tagry.js";function $({contextHelper:i}){const{safeFetch:n}=E(),t=d(),a=f(),{showSuccessSnackbar:c}=x(),{pathname:r}=h(),{vehicleId:o}=v(),s=y.useMemo(()=>t.getQueryData(["vehicle",o]),[t,o]);async function u({payment:e}){const m=P({installment:e.installment,upfront:e.upfront});await n(`${S}/vehicle-expense`,{method:"POST",body:{vehicleId:o,category:e.category,observations:e.observations,competencyDate:e.competencyDate,description:`Gasto Veículo ${V(s==null?void 0:s.vehicle.plateNumber,"plateNumber")}`,paidTo:N[e.category],installments:m},resource:"VEHICLE_EXPENSE",action:"CREATE"})}const{mutate:p,isPending:l}=b({mutationFn:u,onSuccess:()=>{c({title:"Gasto criado com sucesso"}),a(r.replace("/new","")),t.invalidateQueries({queryKey:["vehicle-expenses"]}),t.invalidateQueries({queryKey:["accounts-payable"]})}});return g.jsx(T,{defaultValues:C,onSubmit:p,isPending:l,headerTitle:"Novo Gasto do Veículo",resource:"VEHICLE_EXPENSE",action:"CREATE",onClose:()=>a(r.replace("/new","")),contextHelper:i})}export{$ as default};
